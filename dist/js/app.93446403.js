(function(e){function t(t){for(var l,r,i=t[0],s=t[1],c=t[2],u=0,h=[];u<i.length;u++)r=i[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&h.push(o[r][0]),o[r]=0;for(l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l]);d&&d(t);while(h.length)h.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],l=!0,i=1;i<n.length;i++){var s=n[i];0!==o[s]&&(l=!1)}l&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var l={},o={app:0},a=[];function r(t){if(l[t])return l[t].exports;var n=l[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=l,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)r.d(n,l,function(t){return e[t]}.bind(null,l));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var d=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"1e51":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var l=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("router-link",{attrs:{to:"/"}},[e._v("tableMergeCell")])],1),n("router-view")],1)},a=[],r=(n("5c0b"),n("2877")),i={},s=Object(r["a"])(i,o,a,!1,null,null,null),c=s.exports,d=n("8c4f"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"editor"},[n("div",{domProps:{innerHTML:e._s(e.backendHTML)}})]),n("button",{attrs:{type:"button",id:"btn1"},on:{click:e.getHtml}},[e._v("获取html")]),n("button",{attrs:{type:"button",id:"btn2"},on:{click:e.setHtml}},[e._v("设置html")]),n("div",{ref:"newHtml",staticClass:"newHtml"})])},h=[],v=n("6fad"),f=n.n(v),m=(n("4160"),n("caad"),n("2532"),n("159b"),n("a630"),n("a15b"),n("45fc"),n("0d03"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3"),n("466d"),n("5319"),n("1276"),n("284c")),p=n("9f12"),b=n("53fe"),y=n("2fa7"),g={btnDisabledColor:"#ddd",onAddCol:null},C=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(p["a"])(this,e),Object(y["a"])(this,"colorChange",(function(e){var t=e.target,l=t.value,o=n.colorPicker.selectedCells;o.length&&o.forEach((function(e){e.style.backgroundColor=l})),n.colorPicker&&(n.colorPicker.removeEventListener("input",n.colorChange),n.colorPicker.remove(),n.colorPicker=null),n.removeClass()})),Object(y["a"])(this,"mergeCell",(function(){var e=n.getSelectedCells(),t=n.indexStart,l=n.indexEnd,o=l.row-t.row+1,a=l.col-t.col+1;Array.from(e).forEach((function(e,t){0===t?(e.setAttribute("rowspan",o),e.setAttribute("colspan",a)):e.style.display="none",n.removeClass(e)}))})),Object(y["a"])(this,"unMergeCell",(function(e){var t=null;e?(n.indexStart=n.getCellIndex(e),t=n.getCellSpanProperty(e)):(n.indexStart=n.getCellIndex(n.contextmenuCell),t=n.getCellSpanProperty(n.contextmenuCell)),n.indexEnd={row:t.rowspan-1+n.indexStart.row,col:t.colspan-1+n.indexStart.col};var l=n.getSelectedCells();Array.from(l).forEach((function(e,t){0===t?(e.removeAttribute("rowspan"),e.removeAttribute("colspan")):e.style.display="table-cell",n.removeClass(e)}))})),Object(y["a"])(this,"menuClick",(function(t){var l=t.target,o=window.getComputedStyle(l).color,a=e.colorToRgb(n.opts.btnDisabledColor);if(o!==a){var r=l.dataset.key,i=n.getCellIndex(n.contextmenuCell),s=i.row,c=i.col;switch(r){case"textAlignLeft":n.textAlignLeft();break;case"textAlignCenter":n.textAlignCenter();break;case"textAlignRight":n.textAlignRight();break;case"addBackgroundColor":n.addBackgroundColor();break;case"delBackgroundColor":n.delBackgroundColor();break;case"delTable":n.delTable();break;case"addRow":n.addRow(s);break;case"delRow":n.delRow(s);break;case"addCol":n.addCol(c);break;case"delCol":n.delCol(c);break;case"addTh":n.addTh();break;case"delTh":n.delTh();break;case"merge":n.mergeCell();break;case"unMerge":n.unMergeCell();break}n.menuEle&&(n.menuEle.style.display="none")}})),Object(y["a"])(this,"mousedown",(function(e){var t=e.target,l=e.button;if(!n.tableIsInTable(t)&&0===l){var o=t.tagName;"TD"!==o&&"TH"!==o||(n.ready=!0,n.cellStart=t,n.indexStart=n.getCellIndex(t),n.removeClass(),n.addClass(t))}})),Object(y["a"])(this,"removeSomeNoSelfIsClicked",(function(e){var t=e.target;n.menuEle&&!n.menuEle.contains(t)&&(n.menuEle.style.display="none");var l=t.dataset.key;n.tableEle.contains(t)||"addBackgroundColor"===l||n.removeClass(),n.colorPicker&&n.colorPicker.remove()})),Object(y["a"])(this,"mousemove",(function(e){if(n.ready){var t=e.target;n.cellEnd=t,n.indexEnd=n.getCellIndex(t),n.removeClass(),n.highlightSelectedCells();var l=window.getSelection();n.cellStart!==n.cellEnd&&l.collapseToEnd()}})),Object(y["a"])(this,"mouseup",(function(t){var l=t.target,o=t.button;0===o&&n.ready&&(n.cellEnd=l,n.indexEnd=n.getCellIndex(l),n.ready=!1,n.cellStart!==n.cellEnd&&e.focusEle&&e.focusEle.focus())})),Object(y["a"])(this,"tableClick",(function(e){var t=e.target,l=e.button;0===l&&"INPUT"!==t.tagName&&n.tableEle.contains(t)&&e.stopPropagation()})),Object(y["a"])(this,"contextmenu",(function(e){e.preventDefault();var t=e.target,l=e.clientX,o=e.clientY;if(!n.tableIsInTable(t)){if(!n.menuEle){n.menuEle=document.createElement("ul"),n.menuEle.classList.add("tableMergeCell-contextmenu"),n.menuEle.addEventListener("click",n.menuClick,!1),n.menus.forEach((function(e){var t=document.createElement("li"),l=e.name,o=e.key;t.textContent=l,t.dataset.key=o,n["btn_".concat(o)]=t,n.menuEle.appendChild(t)})),document.body.appendChild(n.menuEle);var a=n.menuEle.getBoundingClientRect(),r=a.width,i=a.height;n.menuEle.dataset.width=r,n.menuEle.dataset.height=i}var s=document.documentElement,c=s.clientWidth,d=s.clientHeight,u=n.menuEle.dataset,h=u.width,v=u.height,f=c-l,m=d-o;f<h?(n.menuEle.style.right="10px",n.menuEle.style.removeProperty("left")):(n.menuEle.style.left="".concat(l,"px"),n.menuEle.style.removeProperty("right")),m<v?n.menuEle.style.height="".concat(m-10,"px"):n.menuEle.style.removeProperty("height"),n.menuEle.style.top="".concat(o,"px"),n.menuEle.style.display="block",n.contextmenuCell=t,n.handleMenuBtnMergeStatus(t),n.handleMenuBtnRowStatus(t),n.handleSomeMenuBtns(t)}})),Object(y["a"])(this,"copy",(function(t){var l=window.getSelection().toString();if(l)e.copyedContent=l;else{t.preventDefault();var o=n.getSelectedCells();if(!o.length)return;var a=[];o.forEach((function(e){a.push(e.outerHTML)})),e.copyedContent=a.join(e.separator),t.clipboardData?t.clipboardData.setData("text/plain",e.copyedContent):window.clipboardData&&window.clipboardData.setData("text",e.copyedContent),e.copyedIndexRange={indexStart:n.indexStart,indexEnd:n.indexEnd},e.copyedCellsArray=n.getSelectedCells(!0)}})),Object(y["a"])(this,"paste",(function(t){var l=n.getSelectedCells();if(l.length&&/<.+>/.test(e.copyedContent)){t.preventDefault();var o=t.clipboardData||window.clipboardData,a=o.getData("text"),r=a.split(e.separator);n.pasteWithRule(l,r),n.indexStart=e.getIndexDefaultValue(),n.indexEnd=e.getIndexDefaultValue()}})),Object(y["a"])(this,"keydown",(function(e){var t=e.key;if("Delete"===t){var l=n.getSelectedCells();l.forEach((function(e){e.innerHTML=""}))}})),this.opts=Object.assign({},g,l),this.tableEle=t,this.tBody=t.tBodies[0],this.rows=this.tBody.rows,this.tableClassName="tableMergeCell",this.menuEle=null,this.menus=[{name:"靠左",key:"textAlignLeft"},{name:"居中",key:"textAlignCenter"},{name:"靠右",key:"textAlignRight"},{name:"设置背景色",key:"addBackgroundColor"},{name:"删除背景色",key:"delBackgroundColor"},{name:"添加行",key:"addRow"},{name:"删除行",key:"delRow"},{name:"添加列",key:"addCol"},{name:"删除列",key:"delCol"},{name:"设置表头",key:"addTh"},{name:"取消表头",key:"delTh"},{name:"合并单元格",key:"merge"},{name:"取消合并单元格",key:"unMerge"},{name:"删除表格",key:"delTable"}],this.selectedCellClassName="tableMergeCell-selected",this.ready=!1,this.cellStart=null,this.cellEnd=null,this.indexStart=e.getIndexDefaultValue(),this.indexEnd=e.getIndexDefaultValue(),this.maxRowCount=0,this.maxColCount=0,this.contextmenuCell=null,this.init()}return Object(b["a"])(e,null,[{key:"colorToRgb",value:function(e){var t=document.createElement("span");t.style.color=e,document.body.appendChild(t);var n=window.getComputedStyle(t).color;return document.body.removeChild(t),n}},{key:"getIndexDefaultValue",value:function(){return{row:-1,col:-1}}}]),Object(b["a"])(e,[{key:"init",value:function(){if(!this.tableEle&&1!==this.tableEle.ELEMENT_NODE&&"TABLE"!==this.tableEle.tagName)throw new Error("请传入table元素！");this.tableEle.classList.add(this.tableClassName),this.addFocusEle(),this.syncMaxRowAndColCount(),this.addEvent()}},{key:"destroy",value:function(){this.removeEvent(),this.menuEle&&(this.menuEle.removeEventListener("click",this.menuClick,!1),this.menuEle.remove()),e.focusEle&&e.focusEle.remove()}},{key:"addFocusEle",value:function(){e.focusEle||(e.focusEle=document.createElement("button"),e.focusEle.className="tableMergeCell-focusEle",document.body.appendChild(e.focusEle))}},{key:"addCellLocation",value:function(){var e=this.rows;e.forEach((function(e,t){var n=e.children;n.forEach((function(e,n){e.textContent=t+"-"+n}))}))}},{key:"syncMaxRowAndColCount",value:function(){var e=this.rows;e.length?(this.maxRowCount=e.length,this.maxColCount=e[0].childElementCount):(this.maxRowCount=0,this.maxColCount=0)}},{key:"addBackgroundColor",value:function(){var e=this.getSelectedCells();if(e.length){this.colorPicker=document.createElement("input"),this.colorPicker.setAttribute("type","color"),this.colorPicker.className="tableMergeCell-colorPicker",this.colorPicker.addEventListener("input",this.colorChange,!1),this.colorPicker.selectedCells=e;var t=e[e.length-1];t.appendChild(this.colorPicker),this.colorPicker.click()}}},{key:"delBackgroundColor",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.removeProperty("background-color")}))}},{key:"tableIsInTable",value:function(e){while(e&&"TABLE"!==e.tagName)e=e.parentNode;return this.tableEle!==e&&this.tableEle.contains(e)}},{key:"addClass",value:function(e){e.className.includes(this.selectedCellClassName)||e.classList.add(this.selectedCellClassName)}},{key:"removeClass",value:function(e){var t=this;if(e)e.classList.remove(this.selectedCellClassName),""===e.className&&e.removeAttribute("class");else{var n=this.tableEle.querySelectorAll(".tableMergeCell-selected");n.length&&n.forEach((function(e){e.classList.remove(t.selectedCellClassName),""===e.className&&e.removeAttribute("class")}))}}},{key:"highlightSelectedCells",value:function(){var e=this,t=this.rows,n=this.selectedCellsIsValid(t);if(n){var l=this.getSelectedCells();l.forEach((function(t){e.addClass(t)}))}}},{key:"getSelectedCells",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexStart,n=this.indexEnd,l=[],o=[],a=this.rows,r=0;r<this.maxRowCount;r++){for(var i=a[r],s=i.children,c=s.length,d=[],u=0;u<c;u++){var h=s[u];r>=t.row&&r<=n.row&&u>=t.col&&u<=n.col&&(l.push(h),d.push(h))}d.length&&o.push(d)}return e?o:l}},{key:"selectedCellsIsValid",value:function(){var e=this,t=this.cellStart.getAttribute("rowspan"),n=this.cellEnd&&this.cellEnd.getAttribute("rowspan");if(t||n)return!1;var l=this.getSelectedCells(),o=Array.from(l).some((function(t){return"none"===t.style.display||e.getIsMergedCellBool(t)}));return!o}},{key:"getCellIndex",value:function(e){var t={row:-1,col:-1};if(!this.cellStart)return t;var n=this.cellStart.tagName,l=this.rows;if("TH"===n){var o=l[0],a=o.children,r=a.length;t.row=0;for(var i=0;i<r;i++){var s=a[i];if(s===e){t.col=i;break}}}else if("TD"===n)for(var c=0;c<this.maxRowCount;c++){for(var d=l[c],u=d.children,h=u.length,v=0;v<h;v++){var f=u[v];if(f===e){t.row=c,t.col=v;break}}if(t.row>0)break}return t}},{key:"getCellSpanProperty",value:function(e){return{rowspan:1*e.getAttribute("rowspan"),colspan:1*e.getAttribute("colspan")}}},{key:"getIsMergedCellBool",value:function(e){var t=this.getCellSpanProperty(e),n=t.rowspan,l=t.colspan,o=Math.max(n,l);return o>1}},{key:"getSelectedCellsByClassName",value:function(){return Array.from(this.tableEle.querySelectorAll(".".concat(this.selectedCellClassName)))}},{key:"getMergedRowIndexArray",value:function(e,t){var n=e+t-1,l=[];do{l.push(e),e++}while(e<=n);return l}},{key:"getMergedColIndexArray",value:function(e,t){var n=e+t-1,l=[];do{l.push(e),e++}while(e<=n);return l}},{key:"handleMenuBtnMergeStatus",value:function(e){var t=this.opts.btnDisabledColor;this.isMergedCell=this.getIsMergedCellBool(e),this.cellStart!==this.cellEnd&&e.className.includes(this.selectedCellClassName)||e.getAttribute("rowspan")?this.getIsMergedCellBool(e)?(this.btn_merge.style.color=t,this.btn_unMerge.style.removeProperty("color")):(this.btn_merge.style.removeProperty("color"),this.btn_unMerge.style.color=t):(this.btn_merge.style.color=t,this.btn_unMerge.style.color=t)}},{key:"handleMenuBtnRowStatus",value:function(e){var t=this.opts.btnDisabledColor;"TH"===e.tagName?this.btn_addRow.style.color=t:this.btn_addRow.style.removeProperty("color");var n=this.getCellSpanProperty(e),l=n.rowspan,o=n.colspan;l>1||o>1?(this.btn_delRow.style.color=t,this.btn_delCol.style.color=t):(this.btn_delRow.style.removeProperty("color"),this.btn_delCol.style.removeProperty("color"))}},{key:"handleSomeMenuBtns",value:function(e){var t=this.opts.btnDisabledColor,n=this.getSelectedCellsByClassName();n.length?(this.btn_textAlignLeft.style.removeProperty("color"),this.btn_textAlignCenter.style.removeProperty("color"),this.btn_textAlignRight.style.removeProperty("color"),this.btn_addBackgroundColor.style.removeProperty("color"),this.btn_delBackgroundColor.style.removeProperty("color")):(this.btn_addBackgroundColor.style.color=t,this.btn_delBackgroundColor.style.color=t,this.btn_textAlignLeft.style.color=t,this.btn_textAlignCenter.style.color=t,this.btn_textAlignRight.style.color=t)}},{key:"handleMergedCellByDelCol",value:function(e){for(var t=this.rows,n=t.length,l=0;l<n;l++)for(var o=t[l],a=o.children,r=a.length,i=0;i<r;i++){var s=a[i],c=this.getCellSpanProperty(s),d=c.colspan;d>1&&e>i&&e<i+d&&s.setAttribute("colspan",d-1)}}},{key:"delTable",value:function(){this.tableEle.remove()}},{key:"delEmptyTable",value:function(){var e=this.rows;e.length&&e[0].children.length||this.delTable()}},{key:"addRow",value:function(e){var t=this,n=this.maxColCount,l=this.tBody,o=this.getRelatedMergedRowCells(e,"addRow"),a=[];o.forEach((function(e){var n=t.getCellSpanProperty(e),l=n.rowspan,o=n.colspan,r=t.getCellIndex(e),i=r.col;a.push.apply(a,Object(m["a"])(t.getMergedColIndexArray(i,o))),e.setAttribute("rowspan",l+1)}));for(var r=l.insertRow(e),i=0;i<n;i++)r.insertCell(i);a.forEach((function(e){r.children[e].style.display="none"})),this.syncMaxRowAndColCount()}},{key:"getRelatedMergedRowCells",value:function(e,t){var n=this,l=this.rows,o=[];return l.forEach((function(l,a){var r=l.children;r.forEach((function(l){var r=n.getCellSpanProperty(l),i=r.rowspan;i>1&&n.rowIsInMergedRow(a,i,e,t)&&o.push(l)}))})),o}},{key:"rowIsInMergedRow",value:function(e,t,n,l){return"addRow"===l?n>e&&n<=e+t-1:"delRow"===l?n>=e&&n<=e+t-1:void 0}},{key:"addCol",value:function(e){var t=this,n=this.opts.onAddCol;this.syncMaxRowAndColCount();for(var l=this.maxRowCount,o=this.rows,a=0;a<l;a++){var r=o[a],i=r.children[e],s="TH"===i.tagName?"<th></th>":"<td></td>";i.insertAdjacentHTML("beforebegin",s)}o.forEach((function(n,l){var a=n.children;a.forEach((function(n,r){var i=t.getCellSpanProperty(n),s=i.rowspan,c=i.colspan;if(c>1&&e>r&&e<=r+c-1){n.setAttribute("colspan",c+1),a[e].style.display="none";var d=s,u=l;while(d>1)o[++u].children[e].style.display="none",d--}}))})),this.syncMaxRowAndColCount(),n&&n()}},{key:"delRow",value:function(e){var t=this,n=this.tBody,l=this.rows,o=this.getRelatedMergedRowCells(e,"delRow");o.forEach((function(n){var o=t.getCellIndex(n),a=o.row,r=o.col;a===e?t.delFirstRow(l,r,n,e):t.delOtherRow(n)})),n.deleteRow(e),this.delEmptyTable(),this.syncMaxRowAndColCount()}},{key:"delOtherRow",value:function(e){var t=this.getCellSpanProperty(e),n=t.rowspan;e.setAttribute("rowspan",n-1)}},{key:"delFirstRow",value:function(e,t,n,l){var o=this.getCellSpanProperty(n),a=o.rowspan,r=o.colspan,i=e[l+1],s=i.children[t];s.setAttribute("rowspan",a-1),s.setAttribute("colspan",r),s.style.display="table-cell"}},{key:"getRelatedMergedColCells",value:function(e){var t=this,n=this.rows,l=[];return n.forEach((function(n){var o=n.children;o.forEach((function(n,o){var a=t.getCellSpanProperty(n),r=a.colspan;r>1&&e>=o&&e<=o+r-1&&l.push(n)}))})),l}},{key:"delOtherCol",value:function(e){var t=this.getCellSpanProperty(e),n=t.colspan;e.setAttribute("colspan",n-1)}},{key:"delFirstCol",value:function(e){var t=this.getCellSpanProperty(e),n=t.rowspan,l=t.colspan,o=e.nextElementSibling;o.setAttribute("colspan",l-1),o.setAttribute("rowspan",n),o.style.display="table-cell"}},{key:"delCol",value:function(e){var t=this,n=(this.tBody,this.rows),l=this.getRelatedMergedColCells(e);l.forEach((function(n){var l=t.getCellIndex(n),o=l.col;o===e?t.delFirstCol(n):t.delOtherCol(n)})),n.forEach((function(t){t.deleteCell(e)})),this.delEmptyTable(),this.syncMaxRowAndColCount()}},{key:"addTh",value:function(){var e=this.rows[0],t=e.children,n=document.createElement("tr");if("TD"===t[0].tagName){for(var l=t.length,o=0;o<l;o++){var a=t[o];if(this.getIsMergedCellBool(a)){alert("请先取消第一行合并的单元格！");break}var r=document.createElement("th");r.innerHTML=a.innerHTML,n.appendChild(r)}n.childElementCount===l&&(e.innerHTML=n.innerHTML)}}},{key:"delTh",value:function(){var e=this.rows[0],t=e.children,n=document.createElement("tr");"TH"===t[0].tagName&&(t.forEach((function(e){var t=document.createElement("td");t.innerHTML=e.innerHTML,n.appendChild(t)})),e.innerHTML=n.innerHTML)}},{key:"textAlignLeft",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="left"}))}},{key:"textAlignCenter",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="center"}))}},{key:"textAlignRight",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="right"}))}},{key:"pasteWithRule",value:function(t,n){var l=t.length,o=n.length;if(1===l&&1===o){var a=t[0],r=n[0],i=this.getCellSpanProperty(a),s=i.rowspan,c=i.colspan,d=r.match(/rowspan="(\d+)"/),u=r.match(/colspan="(\d+)"/),h=0,v=0;d&&d[1]&&(h=1*d[1]),u&&u[1]&&(v=1*u[1]),s===h&&c===v?a.outerHTML=r:(h>1||v>1)&&s<=1&&c<=1?a.outerHTML=r.replace(/rowspan=\"\d+\"\s/,"").replace(/colspan=\"\d+\"\s/,""):(s>1||c>1)&&h<=1&&v<=1&&(a.outerHTML=r.replace("<td",'<td colspan="'.concat(c,'"')).replace("<td",'<td rowspan="'.concat(s,'"')))}else if(l===o)for(var f=0;f<l;f++){var m=t[f],p=n[f],b=this.getCellSpanProperty(m),y=b.rowspan,g=b.colspan,C=p.match(/rowspan="(\d+)"/),w=p.match(/colspan="(\d+)"/),E=0,k=0;C&&C[1]&&(E=1*C[1]),w&&w[1]&&(k=1*w[1]),y===E&&g===k&&(m.outerHTML=p)}else if(o>l&&1===l)for(var x=this.indexStart,S=e.copyedIndexRange,T=S.indexStart,M=S.indexEnd,L={indexStart:x,indexEnd:{row:x.row+M.row-T.row,col:x.col+M.col-T.col}},A=L.indexStart.row,R=L.indexEnd.row,I=L.indexStart.col,P=L.indexEnd.col,O=this.rows,j=A,B=0;j<=R;j++,B++){var H=O[j];if(H)for(var N=H.children,D=I,_=0;D<=P;D++,_++){var W=N[D];if(W){var $=e.copyedCellsArray[B][_],z=this.getCellSpanProperty(W),X=z.rowspan,F=z.colspan;X<=1&&F<=1&&(W.outerHTML=$.outerHTML)}}}}},{key:"addEvent",value:function(){window.addEventListener("mousedown",this.mousedown,!1),window.addEventListener("mousedown",this.removeSomeNoSelfIsClicked,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseup",this.mouseup,!1),this.tableEle.addEventListener("click",this.tableClick,!1),this.tableEle.addEventListener("contextmenu",this.contextmenu,!1),window.addEventListener("copy",this.copy,!1),window.addEventListener("paste",this.paste,!1),window.addEventListener("keydown",this.keydown,!0)}},{key:"removeEvent",value:function(){window.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("mousedown",this.removeSomeNoSelfIsClicked,!1),window.removeEventListener("mousemove",this.mousemove,!1),window.removeEventListener("mouseup",this.mouseup,!1),this.tableEle.removeEventListener("click",this.tableClick,!1),this.tableEle.removeEventListener("contextmenu",this.contextmenu,!1),window.removeEventListener("copy",this.copy,!1),window.removeEventListener("paste",this.paste,!1),window.removeEventListener("keydown",this.keydown,!0)}}]),e}();Object(y["a"])(C,"separator",",%,#,$"),Object(y["a"])(C,"focusEle",null),Object(y["a"])(C,"copyedContent",""),Object(y["a"])(C,"copyedIndexRange",{}),Object(y["a"])(C,"copyedCellsArray",[]);n("720a"),n("99af"),n("d81d"),n("13d5"),n("a9e3"),n("c35a");var w={colMinWidth:50},E=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(p["a"])(this,e),Object(y["a"])(this,"reset",(function(){n.addResizeHandShank(),n.setDefaultWidth()})),Object(y["a"])(this,"mousedown",(function(e){var t=e.target,l=e.button,o=e.clientX;0===l&&t.className.includes(n.handshankCls)?(n.handshank=t,n.handshank.classList.add(n.handshankHover),n.clientX=o,n.addSubline()):n.handshank=null})),Object(y["a"])(this,"mousemove",(function(e){if(n.handshank){e.preventDefault();var t=e.clientX;n.diff=t-n.clientX,n.handshank.style.transform="translateX(".concat(n.diff,"px)")}})),Object(y["a"])(this,"mouseup",(function(e){if(n.handshank){var t=e.clientX,l=n.tableEle.tBodies[0].rows[0],o=n.handshank.dataset.col,a=l.children[o],r=a.getBoundingClientRect(),i=r.width,s=i+n.diff,c=n.opts.colMinWidth,d=Math.max(c,s);n.tableEle.contains(n.handshank)&&t-n.clientX!==0&&(a.style.width="".concat(d,"px")),n.handshank.style.transform="none",n.handshank.classList.remove(n.handshankHover),n.removeSubline();var u=n.getColsWidth();n.setTableWidth(u),n.handshank=null}})),this.opts=Object.assign({},w,l),this.tableEle=t,this.tableEle.columnResizer=Object.assign({},{reset:this.reset}),this.handshank=null,this.handshankCls="tableMergeCell-handshank",this.subline="tableMergeCell-subline",this.handshankHover="tableMergeCell-handshank-hover",this.init()}return Object(b["a"])(e,[{key:"init",value:function(){if(!this.tableEle||1!==this.tableEle.ELEMENT_NODE||"TABLE"!==this.tableEle.tagName)throw new Error("请传入table元素！");this.getDefaultWidth(),this.setDefaultWidth(),this.addResizeHandShank(),this.addEvent()}},{key:"destroy",value:function(){this.removeEvent()}},{key:"getDefaultWidth",value:function(){var e=this.tableEle.getBoundingClientRect(),t=e.width,n=this.tableEle.tBodies[0].rows,l=n[0].childElementCount;this.average=t/l,this.tableWidth=t}},{key:"setDefaultWidth",value:function(){var e=this;this.setTableWidth(this.tableWidth);var t=this.tableEle.tBodies[0].rows,n=t[0].children;n.forEach((function(t){var n=t.style.width;n||(t.style.width="".concat(e.average,"px"))}))}},{key:"addResizeHandShank",value:function(){var e=this,t=this.tableEle.tBodies[0].rows,n=t[0].children;n.forEach((function(t,n){var l=t.querySelector(".".concat(e.handshankCls));l&&l.remove();var o='&emsp;<i data-col="'.concat(n,'" contenteditable="false" class="').concat(e.handshankCls,'"></i>');t.insertAdjacentHTML("beforeend",o)}))}},{key:"addSubline",value:function(){this.handshank.classList.add(this.subline)}},{key:"removeSubline",value:function(){this.handshank.classList.remove(this.subline)}},{key:"setTableWidth",value:function(e){this.tableEle.setAttribute("width","".concat(e,"px"))}},{key:"getColsWidth",value:function(){var e=this.tableEle.tBodies[0].rows,t=e[0].children,n=Array.from(t).map((function(e){return Number.parseFloat(e.style.width)})),l=n.reduce((function(e,t){return e+t}));return l}},{key:"addEvent",value:function(){window.addEventListener("mousedown",this.mousedown,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseup",this.mouseup,!1)}},{key:"removeEvent",value:function(){window.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("mousemove",this.mousemove,!1),window.removeEventListener("mouseup",this.mouseup,!1)}}]),e}(),k=(n("1e51"),{mounted:function(){var e=this;this.$nextTick((function(){e.addInsertTableIconlistener(),e.addPasteTableListener()}))},updated:function(){var e=this;this.$nextTick((function(){e.initTableInteraction()}))},methods:{initTableInteraction:function(){if(!this.$refs.editor)throw new Error('请为wangEditor富文本容器元素提供ref="editor"属性');var e=function(e){while(e&&e.parentNode&&"TABLE"!==e.parentNode.tagName)e=e.parentNode;return e.parentNode};this.tables=this.$refs.editor.querySelectorAll(".w-e-text table"),this.tables.forEach((function(t){e(t)||(t.tableMergeCellInstance||(t.tableMergeCellInstance=new C(t,{onAddCol:function(){t.columnResizer.reset()}})),t.tableColumnResizerInstance||(t.tableColumnResizerInstance=new E(t)))}))},addInsertTextListener:function(){this.insertText=this.iconTable.querySelector("button.right"),this.insertText&&this.insertText.addEventListener("click",this.initTableInteraction,!1)},addInsertTableIconlistener:function(){this.iconTable=this.$refs.editor.querySelector("[data-title='表格']"),this.iconTable&&this.iconTable.addEventListener("click",this.addInsertTextListener,!1)},addPasteTableListener:function(){var e=this;this.$refs.editor.addEventListener("paste",(function(t){var n=(event.clipboardData||window.clipboardData).getData("text/html");n&&n.includes("<table")&&e.initTableInteraction()}),!1)}},beforeDestroy:function(){this.tables&&this.tables.forEach((function(e){e.tableMergeCellInstance&&e.tableMergeCellInstance.destroy(),e.tableColumnResizerInstance&&e.tableColumnResizerInstance.destroy()})),this.tables=null,this.iconTable&&this.iconTable.removeEventListener("click",this.addInsertTextListener,!1),this.insertText&&this.insertText.removeEventListener("click",this.initTableInteraction,!1)}}),x={name:"about",mixins:[k],data:function(){return{backendHTML:""}},mounted:function(){this.initEditor()},methods:{getHtml:function(){this.newHtml=this.editor.txt.html(),this.$refs.newHtml.innerHTML=this.newHtml},setHtml:function(){this.editor.txt.html(this.newHtml)},initEditor:function(){this.editor=new f.a(this.$refs.editor),this.editor.config.onchangeTimeout=200,this.editor.create()}}},S=x,T=(n("e76e"),Object(r["a"])(S,u,h,!1,null,null,null)),M=T.exports;l["a"].use(d["a"]);var L=[{path:"/",name:"home",component:M}],A=new d["a"]({routes:L}),R=A,I=n("2f62");l["a"].use(I["a"]);var P=new I["a"].Store({state:{},mutations:{},actions:{},modules:{}});l["a"].config.productionTip=!1,new l["a"]({router:R,store:P,render:function(e){return e(c)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var l=n("9c0c"),o=n.n(l);o.a},"720a":function(e,t,n){},"91aa":function(e,t,n){},"9c0c":function(e,t,n){},e76e:function(e,t,n){"use strict";var l=n("91aa"),o=n.n(l);o.a}});
//# sourceMappingURL=app.93446403.js.map