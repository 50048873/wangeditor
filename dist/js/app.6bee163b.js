(function(e){function t(t){for(var l,r,o=t[0],s=t[1],c=t[2],h=0,u=[];h<o.length;h++)r=o[h],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&u.push(a[r][0]),a[r]=0;for(l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l]);d&&d(t);while(u.length)u.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],l=!0,o=1;o<n.length;o++){var s=n[o];0!==a[s]&&(l=!1)}l&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var l={},a={app:0},i=[];function r(t){if(l[t])return l[t].exports;var n=l[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=l,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)r.d(n,l,function(t){return e[t]}.bind(null,l));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"07f7":function(e,t,n){},"1e51":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var l=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("router-link",{attrs:{to:"/"}},[e._v("tableMergeCell")])],1),n("router-view")],1)},i=[],r=(n("5c0b"),n("2877")),o={},s=Object(r["a"])(o,a,i,!1,null,null,null),c=s.exports,d=n("8c4f"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"editor"},[n("div",{domProps:{innerHTML:e._s(e.value)}})]),n("button",{attrs:{type:"button",id:"btn1"},on:{click:e.getHtml}},[e._v("获取html")]),n("button",{attrs:{type:"button",id:"btn2"},on:{click:e.setHtml}},[e._v("设置html")]),n("div",{ref:"newHtml",staticClass:"newHtml"}),n("formula-pop",{attrs:{visible:e.visible,type:e.type,latex:e.latex},on:{"update:visible":function(t){e.visible=t},confirm:e.confirm}})],1)},u=[],m=(n("99af"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{attrs:{title:"新增公式",width:"600px",visible:e.visible},on:{ok:e.ok,cancel:e.cancel}},[e.visible?n("math-formula",{attrs:{type:e.type,latex:e.latex}}):e._e()],1)}),v=[],g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"mathFormula"},[n("div",{staticClass:"tabMenu"},[n("ul",{staticClass:"tabTitle"},e._l(e.tabTitle,(function(t,l){return n("li",{key:l,class:{current:l===e.currentIndex},on:{click:function(t){return e.toggle(l)}}},[e._v(" "+e._s(t)+" ")])})),0),n("ul",{staticClass:"tabContent"},e._l(e.currentMathSymbol,(function(t,l){return n("li",{key:l,staticClass:"mathBox",style:e.bgPos(l),on:{click:function(n){return e.insert(t)}}})})),0)]),e._m(0)])},f=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mathDiv",attrs:{id:"mathDiv"}},[n("span",{attrs:{id:"jmeMath"}})])}],b=(n("45fc"),n("ac1f"),n("5319"),["常用公式","字母","符号"]),p=[["{/}frac{}{}","^{}/_{}","x^{}","x_{}","x^{}_{}","{/}bar{}","{/}sqrt{}","{/}nthroot{}{}","{/}sum^{}_{n=}","{/}sum","{/}log_{}","{/}ln","{/}int_{}^{}","{/}oint_{}^{}"],["{/}alpha","{/}beta","{/}gamma","{/}delta","{/}varepsilon","{/}varphi","{/}lambda","{/}mu","{/}rho","{/}sigma","{/}omega","{/}Gamma","{/}Delta","{/}Theta","{/}Lambda","{/}Xi","{/}Pi","{/}Sigma","{/}Upsilon","{/}Phi","{/}Psi","{/}Omega"],["+","-","{/}pm","{/}times","{/}ast","{/}div","/","{/}bigtriangleup","=","{/}ne","{/}approx",">","<","{/}ge","{/}le","{/}infty","{/}cap","{/}cup","{/}because","{/}therefore","{/}subset","{/}supset","{/}subseteq","{/}supseteq","{/}nsubseteq","{/}nsupseteq","{/}in","{/}ni","{/}notin","{/}mapsto","{/}leftarrow","{/}rightarrow","{/}Leftarrow","{/}Rightarrow","{/}leftrightarrow","{/}Leftrightarrow"]],y=[{x:0,y:272},{x:0,y:170},{x:0,y:0}],C={name:"MathFormula",props:{latex:{type:String,default:""},type:{type:String,default:"add",validator:function(e){return["add","edit"].some((function(t){return t===e}))}}},data:function(){return{currentIndex:0}},computed:{currentMathSymbol:function(){return this.mathSymbol[this.currentIndex]}},created:function(){this.tabTitle=b,this.mathSymbol=p},mounted:function(){var e=this;this.$nextTick((function(){window.$("#jmeMath").mathquill("editable").mathquill("write",e.latex)}))},methods:{toggle:function(e){this.currentIndex=e},bgPos:function(e){var t=34,n=y[this.currentIndex],l=n.x,a=n.y;return{backgroundPosition:"-".concat(l+Math.floor(e%8)*t,"px -").concat(a+Math.floor(e/8)*t,"px")}},insert:function(e){window.$("#jmeMath").focus().mathquill("write",e.replace("{/}","\\"))}}},w=C,E=(n("be5c"),Object(r["a"])(w,g,f,!1,null,null,null)),k=E.exports,x={name:"FormulaPop",components:{MathFormula:k},props:{visible:{type:Boolean,default:!1},latex:{type:String,default:""},type:{type:String,default:"add"}},methods:{ok:function(){var e=window.$("#jmeMath"),t=e.mathquill("latex");this.$emit("confirm",t),this.$emit("update:visible",!1)},cancel:function(){this.$emit("update:visible",!1)}}},M=x,T=Object(r["a"])(M,m,v,!1,null,null,null),A=T.exports,S=n("6fad"),L=n.n(S),I=(n("a4d3"),n("e01a"),n("d28b"),n("4160"),n("caad"),n("0d03"),n("b0c0"),n("d3b7"),n("25f0"),n("2532"),n("3ca3"),n("466d"),n("159b"),n("ddb0"),n("e587")),P=(n("a630"),n("a9e3"),n("c35a"),n("25eb"),n("1276"),n("284c")),N=n("9f12"),R=n("53fe"),_=n("2fa7"),O=n("ed3b"),j=(n("cd09"),{btnDisabledColor:"#ddd",onAddCol:null,onDelCol:null,imgMinWidth:20}),B=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(N["a"])(this,e),Object(_["a"])(this,"colorChange",(function(e){var t=e.target,l=t.value,a=n.colorPicker.selectedCells;a.length&&a.forEach((function(e){e.style.backgroundColor=l})),n.colorPicker&&(n.colorPicker.removeEventListener("input",n.colorChange),n.colorPicker.remove(),n.colorPicker=null),n.removeClass()})),Object(_["a"])(this,"mergeCell",(function(){for(var e=n.getSelectedCells(),t=e.length,l=n.indexStart,a=n.indexEnd,i=a.row-l.row+1,r=a.col-l.col+1,o=null,s=0;s<t;s++){var c=e[s];if(c.innerText){o=c;break}}e.forEach((function(e,t){if(0===t){if(e.setAttribute("rowspan",i),e.setAttribute("colspan",r),!e.innerText&&o){e.innerHTML=o.innerHTML,e.removeAttribute("style");var l=o.getAttribute("style");l&&e.setAttribute("style",l)}}else e.style.display="none";n.removeClass(e)}))})),Object(_["a"])(this,"unMergeCell",(function(){var e=null;n.indexStart=n.getCellIndex(n.cellEnd),e=n.getCellSpanProperty(n.cellEnd),n.indexEnd={row:e.rowspan-1+n.indexStart.row,col:e.colspan-1+n.indexStart.col};var t=n.getSelectedCells();t.forEach((function(e,t){0===t?(e.removeAttribute("rowspan"),e.removeAttribute("colspan")):e.style.removeProperty("display"),n.removeClass(e)}))})),Object(_["a"])(this,"menuClick",(function(t){var l=t.target,a=window.getComputedStyle(l).color,i=e.colorToRgb(n.opts.btnDisabledColor);if(a!==i){var r=l.dataset.key,o=n.getCellIndex(n.contextmenuCell),s=o.row,c=o.col;switch(r){case"copyTable":n.copyTable();break;case"textAlignLeft":n.textAlignLeft();break;case"textAlignCenter":n.textAlignCenter();break;case"textAlignRight":n.textAlignRight();break;case"addBackgroundColor":n.addBackgroundColor();break;case"delBackgroundColor":n.delBackgroundColor();break;case"delTable":n.delTable();break;case"addRow":n.addRow(s);break;case"delRow":n.delRow(s);break;case"addCol":n.addCol(c);break;case"delCol":n.delCol(c);break;case"addTh":n.addTh();break;case"delTh":n.delTh();break;case"merge":n.mergeCell();break;case"unMerge":n.unMergeCell();break}n.menuEle&&(n.menuEle.style.display="none")}})),Object(_["a"])(this,"mousedown",(function(t){var l=t.target,a=t.button;if(!(n.imgMasklayer&&n.imgMasklayer.contains(l)||"IMG"===l.tagName)&&!n.tableIsInTable(l)&&!e.isTheadChild(l)&&0===a){l=e.getTargetParentCell(l);var i=l,r=i.tagName;"TD"!==r&&"TH"!==r||(n.ready=!0,n.cellStart=l,n.indexStart=n.getCellIndex(l),n.removeClass(),n.addClass(l))}})),Object(_["a"])(this,"removeSomeNoSelfIsClicked",(function(e){var t=e.target;n.menuEle&&!n.menuEle.contains(t)&&(n.menuEle.style.display="none");var l=t.dataset.key;!t||n.tableEle.contains(t)||"addBackgroundColor"===l||t.className.includes("tableMergeCell-contextmenu")||n.removeClass(),n.colorPicker&&n.colorPicker.remove(),n.imgMasklayer&&!n.imgMasklayer.contains(t)&&(n.imgMasklayer.removeEventListener("click",n.handleImgBtn,!1),n.imgMasklayer.removeEventListener("keydown",n.handleImgEnter,!1),n.imgMasklayer.insertAdjacentElement("beforebegin",n.selectedImg),n.imgMasklayer.remove())})),Object(_["a"])(this,"mousemove",(function(t){var l=t.target;l=e.getTargetParentCell(l),n.ready&&n.tableEle.contains(l)&&(clearTimeout(n.timer),n.timer=setTimeout((function(){var e=n.getCellSpanProperty(l),t=e.rowspan,a=e.colspan;if(!(t>1||a>1)){n.cellEnd=l,n.indexEnd=n.getCellIndex(l),n.removeClass(),n.highlightSelectedCells();var i=window.getSelection();n.cellStart!==n.cellEnd&&i.collapseToEnd()}}),1e3/60))})),Object(_["a"])(this,"mouseup",(function(t){var l=t.target,a=t.button;0===a&&n.ready&&(l=e.getTargetParentCell(l),n.tableEle.contains(l)&&(n.cellEnd=l,n.indexEnd=n.getCellIndex(l),n.activeTable()),n.ready=!1)})),Object(_["a"])(this,"tableClick",(function(e){var t=e.target,l=e.button,a=t.tagName;if(0===l&&n.tableEle.contains(t)&&e.stopPropagation(),"A"===a){var i=t.getAttribute("href");window.open(i)}"IMG"===a&&n.handleImg(t)})),Object(_["a"])(this,"contextmenu",(function(t){var l=t.target,a=t.clientX,i=t.clientY;if("IMG"!==l.tagName&&(t.preventDefault(),!n.tableIsInTable(l))){if(!n.menuEle){n.menuEle=document.createElement("ul"),n.menuEle.classList.add("tableMergeCell-contextmenu"),n.menuEle.addEventListener("click",n.menuClick,!1),n.menus.forEach((function(e){var t=document.createElement("li"),l=e.name,a=e.key;t.textContent=l,t.dataset.key=a,n["btn_".concat(a)]=t,n.menuEle.appendChild(t)})),document.body.appendChild(n.menuEle);var r=n.menuEle.getBoundingClientRect(),o=r.width,s=r.height;n.menuEle.dataset.width=o,n.menuEle.dataset.height=s}var c=document.documentElement,d=c.clientWidth,h=c.clientHeight,u=n.menuEle.dataset,m=u.width,v=u.height,g=d-a,f=h-i;g<m?(n.menuEle.style.right="10px",n.menuEle.style.removeProperty("left")):(n.menuEle.style.left="".concat(a,"px"),n.menuEle.style.removeProperty("right")),f<v?n.menuEle.style.height="".concat(f-10,"px"):n.menuEle.style.removeProperty("height"),n.menuEle.style.top="".concat(i,"px"),n.menuEle.style.display="block",n.contextmenuCell=e.getTargetParentCell(l),n.handleMenuBtnMergeStatus(l),n.handleMenuBtnRowStatus(l),n.handleSomeMenuBtns(l)}})),Object(_["a"])(this,"copy",(function(t){var l=window.getSelection().toString(),a=n.getSelectedCells(!0);l?(t.stopPropagation(),console.log("监听整个表格复制命令（document.execCommand()），清空拷贝的单元格数据"),e.copyedCellsArray=[]):Array.isArray(a)&&(t.stopPropagation(),t.preventDefault(),console.log("复制单元格"),t.clipboardData?t.clipboardData.setData("text/plain",""):window.clipboardData&&window.clipboardData.setData("text",""),e.copyedCellsArray=a)})),Object(_["a"])(this,"paste",(function(t){var l=n.getSelectedCells(!0),a=t.clipboardData||window.clipboardData;if(a.items.length>2){t.preventDefault(),t.stopPropagation();var i=a.getData("text"),r=e.handleExcelData(i);n.handlePaste(l,r)}else e.copyedCellsArray.length&&(t.preventDefault(),n.handlePaste(l,e.copyedCellsArray),n.indexStart=e.getIndexDefaultValue(),n.indexEnd=e.getIndexDefaultValue())})),Object(_["a"])(this,"keydown",(function(e){var t=e.key;if("Delete"===t){var l=n.getSelectedCells();l.forEach((function(e){e.innerHTML=""}))}})),Object(_["a"])(this,"handleImgEnter",(function(e){var t=e.key,l=e.target;"Enter"===t&&l.className.includes("tableMergeCell-imgInput")&&n.handleImgWidth(l)})),Object(_["a"])(this,"handleImgBtn",(function(e){var t=e.target;if(t.className.includes("tableMergeCell-imgBtn")){var l=t.previousElementSibling;n.handleImgWidth(l)}})),this.opts=Object.assign({},j,l),this.tableEle=t,this.tBody=t.tBodies[0],this.rows=this.tBody.rows,this.tableClassName="tableMergeCell",this.menuEle=null,this.menus=[{name:"复制表格",key:"copyTable"},{name:"靠左",key:"textAlignLeft"},{name:"居中",key:"textAlignCenter"},{name:"靠右",key:"textAlignRight"},{name:"设置背景色",key:"addBackgroundColor"},{name:"删除背景色",key:"delBackgroundColor"},{name:"合并单元格",key:"merge"},{name:"取消合并单元格",key:"unMerge"},{name:"添加行",key:"addRow"},{name:"删除行",key:"delRow"},{name:"添加列",key:"addCol"},{name:"删除列",key:"delCol"},{name:"设置表头",key:"addTh"},{name:"取消表头",key:"delTh"},{name:"删除表格",key:"delTable"}],this.selectedCellClassName="tableMergeCell-selected",this.ready=!1,this.cellStart=null,this.cellEnd=null,this.indexStart=e.getIndexDefaultValue(),this.indexEnd=e.getIndexDefaultValue(),this.maxRowCount=0,this.maxColCount=0,this.contextmenuCell=null,this.init()}return Object(R["a"])(e,null,[{key:"colorToRgb",value:function(e){var t=document.createElement("span");t.style.color=e,document.body.appendChild(t);var n=window.getComputedStyle(t).color;return document.body.removeChild(t),n}},{key:"getIndexDefaultValue",value:function(){return{row:-1,col:-1}}},{key:"getTargetParentCell",value:function(e){while("TD"!==e.tagName&&"TH"!==e.tagName&&e.parentNode)e=e.parentNode;return e}},{key:"isTheadChild",value:function(e){while("THEAD"!==e.tagName&&e.parentNode)e=e.parentNode;return"THEAD"===e.tagName}},{key:"handleExcelData",value:function(e){e=e.replace(/\n/g,"n").replace(/\s/g,",").replace(/,{2,}/g,","),e=e.substring(0,e.length-2);var t=e.split(",n"),n=[];return t.forEach((function(e){var t=e.split(",");n.push(t)})),n}}]),Object(R["a"])(e,[{key:"init",value:function(){if(!this.tableEle&&1!==this.tableEle.ELEMENT_NODE&&"TABLE"!==this.tableEle.tagName)throw new Error("请传入table元素！");this.tableEle.classList.add(this.tableClassName),this.handleTableFromExcel(),this.syncMaxRowAndColCount(),this.addEvent()}},{key:"destroy",value:function(){this.removeEvent(),this.menuEle&&(this.menuEle.removeEventListener("click",this.menuClick,!1),this.menuEle.remove())}},{key:"handleTableFromExcel",value:function(){var e=Object(I["a"])(this.tableEle.children,2),t=e[0],n=e[1];if("COLGROUP"===t.tagName)for(var l=n.children,a=l.length,i=0;i<a;i++)for(var r=l[i],o=r.cells,s=o.length,c=0;c<s;c++){var d=o[c],h=d.getAttribute("rowspan"),u=d.getAttribute("colspan");if(h>=1)for(var m=1;m<h;m++){var v=l[i+m].insertCell(c);v.style.display="none"}if(u>=1)for(var g=1;g<u;g++){var f=r.insertCell(c+g);f.style.display="none"}}}},{key:"addCellLocation",value:function(){var e=this.rows;e.forEach((function(e,t){var n=e.children;n.forEach((function(e,n){e.textContent=t+"-"+n}))}))}},{key:"syncMaxRowAndColCount",value:function(){var e=this.rows;e.length?(this.maxRowCount=e.length,this.maxColCount=e[0].childElementCount):(this.maxRowCount=0,this.maxColCount=0)}},{key:"addBackgroundColor",value:function(){var e=this,t=this.getSelectedCells();if(t.length){this.colorPicker=document.createElement("input"),this.colorPicker.setAttribute("type","color"),this.colorPicker.className="tableMergeCell-colorPicker",this.colorPicker.addEventListener("input",this.colorChange,!1),this.colorPicker.selectedCells=t;var n=t[t.length-1];n.appendChild(this.colorPicker),setTimeout((function(){e.colorPicker.click()}),20)}}},{key:"delBackgroundColor",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.removeProperty("background-color")}))}},{key:"tableIsInTable",value:function(e){while(e&&"TABLE"!==e.tagName)e=e.parentNode;return this.tableEle!==e&&this.tableEle.contains(e)}},{key:"addClass",value:function(e){e.className.includes(this.selectedCellClassName)||e.classList.add(this.selectedCellClassName)}},{key:"removeClass",value:function(e){var t=this;if(e)e.classList.remove(this.selectedCellClassName),""===e.className&&e.removeAttribute("class");else{var n=this.tableEle.querySelectorAll(".tableMergeCell-selected");n.length&&n.forEach((function(e){e.classList.remove(t.selectedCellClassName),""===e.className&&e.removeAttribute("class")}))}}},{key:"highlightSelectedCells",value:function(){var e=this,t=this.rows,n=this.selectedCellsIsValid(t);if(n){var l=this.getSelectedCells();l.forEach((function(t){e.addClass(t)}))}}},{key:"getSelectedCells",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexStart,n=this.indexEnd,l=[],a=[],i=this.rows,r=0;r<this.maxRowCount;r++){for(var o=i[r],s=o.children,c=s.length,d=[],h=0;h<c;h++){var u=s[h];r>=t.row&&r<=n.row&&h>=t.col&&h<=n.col&&(l.push(u),d.push(u))}d.length&&a.push(d)}return e?a:l}},{key:"selectedCellsIsValid",value:function(){var e=this,t=this.cellStart.getAttribute("rowspan"),n=this.cellEnd&&this.cellEnd.getAttribute("rowspan");if(t||n)return!1;var l=this.getSelectedCells(),a=l.some((function(t){return"none"===t.style.display||e.getIsMergedCellBool(t)}));return!a}},{key:"getCellIndex",value:function(e){var t={row:-1,col:-1};if(!this.cellStart)return t;var n=this.cellStart.tagName,l=this.rows;if("TH"===n){var a=l[0],i=a.children,r=i.length;t.row=0;for(var o=0;o<r;o++){var s=i[o];if(s===e){t.col=o;break}}}else if("TD"===n)for(var c=0;c<this.maxRowCount;c++){for(var d=l[c],h=d.children,u=h.length,m=0;m<u;m++){var v=h[m];if(v===e){t.row=c,t.col=m;break}}if(t.row>0)break}return t}},{key:"getCellSpanProperty",value:function(e){var t=e.getAttribute("rowspan"),n=e.getAttribute("colspan");return t=t?1*t:1,n=n?1*n:1,{rowspan:t,colspan:n}}},{key:"getIsMergedCellBool",value:function(e){var t=this.getCellSpanProperty(e),n=t.rowspan,l=t.colspan,a=Math.max(n,l);return a>1}},{key:"getSelectedCellsByClassName",value:function(){return Array.from(this.tableEle.querySelectorAll(".".concat(this.selectedCellClassName)))}},{key:"getMergedRowIndexArray",value:function(e,t){var n=e+t-1,l=[];do{l.push(e),e++}while(e<=n);return l}},{key:"getMergedColIndexArray",value:function(e,t){var n=e+t-1,l=[];do{l.push(e),e++}while(e<=n);return l}},{key:"handleMenuBtnMergeStatus",value:function(e){var t=this.opts.btnDisabledColor;this.isMergedCell=this.getIsMergedCellBool(e);var n=this.getSelectedCellsByClassName();n.length?this.cellStart===this.cellEnd?this.cellEnd.getAttribute("rowspan")||this.cellEnd.getAttribute("colspan")?this.btn_unMerge.style.removeProperty("color"):(this.btn_merge.style.color=t,this.btn_unMerge.style.color=t):this.getIsMergedCellBool(e)?(this.btn_merge.style.color=t,this.btn_unMerge.style.removeProperty("color")):(this.btn_merge.style.removeProperty("color"),this.btn_unMerge.style.color=t):(this.btn_merge.style.color=t,this.btn_unMerge.style.color=t)}},{key:"handleMenuBtnRowStatus",value:function(e){var t=this.opts.btnDisabledColor;"TH"===e.tagName?this.btn_addRow.style.color=t:this.btn_addRow.style.removeProperty("color");var n=this.getCellSpanProperty(e),l=n.rowspan,a=n.colspan;l>1||a>1?(this.btn_delRow.style.color=t,this.btn_delCol.style.color=t):(this.btn_delRow.style.removeProperty("color"),this.btn_delCol.style.removeProperty("color"))}},{key:"handleSomeMenuBtns",value:function(){var e=this.opts.btnDisabledColor,t=this.getSelectedCellsByClassName();t.length?(this.btn_textAlignLeft.style.removeProperty("color"),this.btn_textAlignCenter.style.removeProperty("color"),this.btn_textAlignRight.style.removeProperty("color"),this.btn_addBackgroundColor.style.removeProperty("color"),this.btn_delBackgroundColor.style.removeProperty("color"),this.btn_addRow.style.removeProperty("color"),this.btn_delRow.style.removeProperty("color"),this.btn_addCol.style.removeProperty("color"),this.btn_delCol.style.removeProperty("color")):(this.btn_addBackgroundColor.style.color=e,this.btn_delBackgroundColor.style.color=e,this.btn_textAlignLeft.style.color=e,this.btn_textAlignCenter.style.color=e,this.btn_textAlignRight.style.color=e,this.btn_addRow.style.color=e,this.btn_delRow.style.color=e,this.btn_addCol.style.color=e,this.btn_delCol.style.color=e)}},{key:"handleMergedCellByDelCol",value:function(e){for(var t=this.rows,n=t.length,l=0;l<n;l++)for(var a=t[l],i=a.children,r=i.length,o=0;o<r;o++){var s=i[o],c=this.getCellSpanProperty(s),d=c.colspan;d>1&&e>o&&e<o+d&&s.setAttribute("colspan",d-1)}}},{key:"delTable",value:function(){this.tableEle.remove()}},{key:"delEmptyTable",value:function(){var e=this.rows;e.length&&e[0].children.length||this.delTable()}},{key:"addRow",value:function(e){var t=this,n=this.maxColCount,l=this.tBody,a=this.getRelatedMergedRowCells(e,"addRow"),i=[];a.forEach((function(e){var n=t.getCellSpanProperty(e),l=n.rowspan,a=n.colspan,r=t.getCellIndex(e),o=r.col;i.push.apply(i,Object(P["a"])(t.getMergedColIndexArray(o,a))),e.setAttribute("rowspan",l+1)}));for(var r=l.insertRow(e),o=0;o<n;o++)r.insertCell(o);i.forEach((function(e){r.children[e].style.display="none"})),this.syncMaxRowAndColCount()}},{key:"getRelatedMergedRowCells",value:function(e,t){var n=this,l=this.rows,a=[];return l.forEach((function(l,i){var r=l.children;r.forEach((function(l){var r=n.getCellSpanProperty(l),o=r.rowspan;o>1&&n.rowIsInMergedRow(i,o,e,t)&&a.push(l)}))})),a}},{key:"rowIsInMergedRow",value:function(e,t,n,l){return"addRow"===l?n>e&&n<=e+t-1:"delRow"===l?n>=e&&n<=e+t-1:void 0}},{key:"addCol",value:function(e){var t=this,n=this.opts.onAddCol;this.syncMaxRowAndColCount();for(var l=this.maxRowCount,a=this.rows,i=0;i<l;i++){var r=a[i],o=r.children[e],s="TH"===o.tagName?"<th></th>":"<td></td>";o.insertAdjacentHTML("beforebegin",s)}a.forEach((function(n,l){var i=n.children;i.forEach((function(n,r){var o=t.getCellSpanProperty(n),s=o.rowspan,c=o.colspan;if(c>1&&e>r&&e<=r+c-1){n.setAttribute("colspan",c+1),i[e].style.display="none";var d=s,h=l;while(d>1)a[++h].children[e].style.display="none",d--}}))})),this.syncMaxRowAndColCount(),n&&n(e)}},{key:"delRow",value:function(e){var t=this,n=this.tBody,l=this.rows,a=this.getRelatedMergedRowCells(e,"delRow");a.forEach((function(n){var a=t.getCellIndex(n),i=a.row,r=a.col;i===e?t.delFirstRow(l,r,n,e):t.delOtherRow(n)})),n.deleteRow(e),this.delEmptyTable(),this.syncMaxRowAndColCount()}},{key:"delOtherRow",value:function(e){var t=this.getCellSpanProperty(e),n=t.rowspan;e.setAttribute("rowspan",n-1)}},{key:"delFirstRow",value:function(e,t,n,l){var a=this.getCellSpanProperty(n),i=a.rowspan,r=a.colspan,o=e[l+1],s=o.children[t];s.setAttribute("rowspan",i-1),s.setAttribute("colspan",r),s.style.display="table-cell"}},{key:"getRelatedMergedColCells",value:function(e){var t=this,n=this.rows,l=[];return n.forEach((function(n){var a=n.children;a.forEach((function(n,a){var i=t.getCellSpanProperty(n),r=i.colspan;r>1&&e>=a&&e<=a+r-1&&l.push(n)}))})),l}},{key:"delOtherCol",value:function(e){var t=this.getCellSpanProperty(e),n=t.colspan;e.setAttribute("colspan",n-1)}},{key:"delFirstCol",value:function(e){var t=this.getCellSpanProperty(e),n=t.rowspan,l=t.colspan,a=e.nextElementSibling;a.setAttribute("colspan",l-1),a.setAttribute("rowspan",n),a.style.display="table-cell"}},{key:"delCol",value:function(e){var t=this,n=this.opts.onDelCol,l=this.rows,a=this.getRelatedMergedColCells(e);a.forEach((function(n){var l=t.getCellIndex(n),a=l.col;a===e?t.delFirstCol(n):t.delOtherCol(n)})),l.forEach((function(t){t.deleteCell(e)})),this.delEmptyTable(),this.syncMaxRowAndColCount(),n&&n(e)}},{key:"addTh",value:function(){var e=this.rows[0],t=e.children,n=document.createElement("tr");if("TD"===t[0].tagName){for(var l=t.length,a=0;a<l;a++){var i=t[a];if(this.getIsMergedCellBool(i)){O["a"]&&O["a"].confirm({title:"提示",content:"请先手动取消第一行合并的单元格！",zIndex:10009});break}var r=document.createElement("th");r.innerHTML=i.innerHTML,n.appendChild(r)}n.childElementCount===l&&(e.innerHTML=n.innerHTML)}}},{key:"delTh",value:function(){var e=this.rows[0],t=e.children,n=document.createElement("tr");"TH"===t[0].tagName&&(t.forEach((function(e){var t=document.createElement("td");t.innerHTML=e.innerHTML,n.appendChild(t)})),e.innerHTML=n.innerHTML)}},{key:"textAlignLeft",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="left"}))}},{key:"textAlignCenter",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="center"}))}},{key:"textAlignRight",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="right"}))}},{key:"copyTable",value:function(){console.log("复制表格，localStorage缓存表格数据，并执行document.execCommand(copy)命令");var e=document.querySelector(".tableMergeCell_active");if(e&&e.classList.remove("tableMergeCell_active"),this.tableEle.classList.add("tableMergeCell_active"),window.localStorage.setItem("tableMergeCell_active",this.tableEle.outerHTML),this.tableEle.classList.contains("tableMergeCell_active")){var t=" ",n=document.createElement("INPUT");n.style.opacity=0,n.style.position="absolute",n.style.left="-100000px",document.body.appendChild(n),n.value=t,n.select(),n.setSelectionRange(0,t.length),document.execCommand("copy"),document.body.removeChild(n)}}},{key:"activeTable",value:function(){var e=this.rows,t=e[0],n=e[e.length-1],l=t.firstElementChild,a=n.lastElementChild;l==this.cellStart&&a==this.cellEnd&&(console.log("select all"),this.copyTable())}},{key:"handlePaste",value:function(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new Error("粘贴单元格或复制单元格不是数组");var n=e.length,l=t.length,a=e[0],i=t[0];if(!a)throw new Error("粘贴的单元格未获取到第一行");if(!i)throw new Error("复制的单元格未获取到第一行");var r=a.length,o=i.length;if(n===l&&r===o)for(var s=0;s<n;s++)for(var c=e[s],d=t[s],h=0;h<r;h++){var u=c[h],m=d[h];if(u&&m)if("string"!==typeof m){var v=this.getCellSpanProperty(u),g=v.rowspan,f=v.colspan,b=this.getCellSpanProperty(m),p=b.rowspan,y=b.colspan;if(g===p&&f===y)u.outerHTML=m.outerHTML;else{var C=m.cloneNode(!0);(p>1||y>1)&&g<=1&&f<=1?(C.removeAttribute("rowspan"),C.removeAttribute("colspan"),u.outerHTML=C.outerHTML):(g>1||f>1)&&p<=1&&y<=1&&(C.setAttribute("rowspan",g),C.setAttribute("colspan",f),u.outerHTML=C.outerHTML)}}else u.innerText=m}else if((l>1||o>1)&&1===n&&1===r)for(var w=this.indexStart,E={indexStart:w,indexEnd:{row:w.row+l-1,col:w.col+o-1}},k=E.indexStart.row,x=E.indexEnd.row,M=E.indexStart.col,T=E.indexEnd.col,A=this.rows,S=k,L=0;S<=x;S++,L++){var I=A[S];if(I)for(var P=I.children,N=M,R=0;N<=T;N++,R++){var _=P[N];if(_){var j=t[L][R];if(_&&j)if("string"!==typeof j){var B=this.getCellSpanProperty(_),H=B.rowspan,D=B.colspan;H<=1&&D<=1&&(_.outerHTML=j.outerHTML)}else _.innerText=j}}}else O["a"]&&O["a"].confirm({title:"提示",content:"目前只支持两种模式：1、复制时选择的行列与粘贴时选择的行列相同（简称一对一或多对多）；2、复制时选择的行列不限，粘贴时只选一个单元格（简称多对一）；",zIndex:10009})}},{key:"handleImg",value:function(e){this.selectedImg=e;var t=this.selectedImg.getBoundingClientRect(),n=t.width,l=t.height;this.imgOriginWidth=n,this.selectedImg.insertAdjacentHTML("beforebegin",'\n            <div contenteditable="false" class="tableMergeCell-imgTooltip" style="width: '.concat(n,"px; height: ").concat(l,'px;">\n                <span class="tableMergeCell-imgInputWrap">\n                    <input value="').concat(n,'px" class="tableMergeCell-imgInput" title="调整图片至特定宽度">\n                    <button type="button" class="tableMergeCell-imgBtn">确定</button>\n                </span>\n            </div>')),this.imgMasklayer=this.tableEle.querySelector(".tableMergeCell-imgTooltip"),this.imgMasklayer.insertAdjacentElement("afterbegin",this.selectedImg),this.imgMasklayer&&(this.imgMasklayer.addEventListener("click",this.handleImgBtn,!1),this.imgMasklayer.addEventListener("keydown",this.handleImgEnter,!1))}},{key:"handleImgWidth",value:function(e){var t,n=e.value,l=this.opts.imgMinWidth;if(/^\d+/.test(n)?t=Number.parseInt(n):e.value="".concat(this.imgOriginWidth,"px"),t<l)O["a"]&&O["a"].confirm({title:"提示",content:"图片最小宽为".concat(l,"像素！"),zIndex:10009});else{var a=function(e){while("TD"!==e.tagName&&e.parentNode)e=e.parentNode;return e},i=a(this.imgMasklayer);if(i&&"TD"===i.tagName){var r=window.getComputedStyle(i),o=r.width,s=r.paddingRight,c=r.paddingLeft,d=r.borderRightWidth,h=Number.parseFloat(o)-Number.parseFloat(s)-Number.parseFloat(c)-Number.parseFloat(d);if(t>h)return void(O["a"]&&O["a"].confirm({title:"提示",content:"图片的宽不能超过单元格的宽，请先调整列宽到合适的宽度！",zIndex:10009}))}if("number"===typeof t&&t!==this.imgOriginWidth){this.selectedImg.style.width="".concat(t,"px");var u=this.selectedImg.getBoundingClientRect(),m=u.width,v=u.height;this.imgMasklayer.style.width="".concat(m,"px"),this.imgMasklayer.style.height="".concat(v,"px")}this.imgMasklayer&&(this.imgMasklayer.removeEventListener("click",this.handleImgBtn,!1),this.imgMasklayer.removeEventListener("keydown",this.handleImgEnter,!1),this.imgMasklayer.insertAdjacentElement("beforebegin",this.selectedImg),this.imgMasklayer.remove())}}},{key:"addEvent",value:function(){this.tableEle.addEventListener("mousedown",this.mousedown,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseup",this.mouseup,!1),this.tableEle.addEventListener("click",this.tableClick,!1),this.tableEle.addEventListener("contextmenu",this.contextmenu,!1),this.tableEle.addEventListener("copy",this.copy,!1),this.tableEle.addEventListener("paste",this.paste,!1),window.addEventListener("mousedown",this.removeSomeNoSelfIsClicked,!0),window.addEventListener("keydown",this.keydown,!0)}},{key:"removeEvent",value:function(){this.tableEle.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("mousemove",this.mousemove,!1),window.removeEventListener("mouseup",this.mouseup,!1),this.tableEle.removeEventListener("click",this.tableClick,!1),this.tableEle.removeEventListener("contextmenu",this.contextmenu,!1),this.tableEle.removeEventListener("copy",this.copy,!1),this.tableEle.removeEventListener("paste",this.paste,!1),window.removeEventListener("mousedown",this.removeSomeNoSelfIsClicked,!0),window.removeEventListener("keydown",this.keydown,!0)}}]),e}();Object(_["a"])(B,"copyedCellsArray",[]);n("720a"),n("d81d"),n("13d5"),n("b680");var H={colMinWidth:50},D=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(N["a"])(this,e),Object(_["a"])(this,"handleAddCol",(function(e){n.addOneCol(e),n.handleResizeHandShank();var t=n.getColsWidth();n.setTableWidth(t)})),Object(_["a"])(this,"mousedown",(function(e){var t=e.target,l=e.button,a=e.clientX;n.tableEle.contains(t)&&0===l&&t.className.includes(n.handshankCls)?(n.handshank=t,n.handshank.classList.add(n.handshankHover),n.clientX=a,n.addSubline()):n.handshank=null})),Object(_["a"])(this,"mousemove",(function(e){if(n.handshank){e.preventDefault();var t=e.clientX;n.diff=t-n.clientX,n.handshank.style.transform="translateX(".concat(n.diff,"px)")}})),Object(_["a"])(this,"mouseup",(function(e){if(n.handshank){var t=e.clientX,l=n.handshank.dataset.col,a=n.colgroup.children[l];if(a){var i=Number.parseInt(a.style.width),r=i+n.diff,o=n.opts.colMinWidth,s=Math.max(o,r);n.tableEle.contains(n.handshank)&&t-n.clientX!==0&&(a.style.width="".concat(s,"px"))}n.handshank.style.removeProperty("transform"),n.handshank.classList.remove(n.handshankHover,n.subline),n.handshank=null;var c=n.getColsWidth();n.setTableWidth(c)}})),Object(_["a"])(this,"input",(function(){var e=n.tableEle.tBodies[0],t=e.rows[0],l=t.children[0],a=l.getBoundingClientRect(),i=a.height,r=n.thead.children[0].children;i>30?r.forEach((function(e){var t=e.querySelector(".".concat(n.handshankCls));t.style.height="".concat(i,"px")})):r.forEach((function(e){var t=e.querySelector(".".concat(n.handshankCls));t.style.removeProperty("height")}))})),this.opts=Object.assign({},H,l),this.isExcelTable=!1,this.tableEle=t,this.colgroup=t.querySelector("colgroup"),this.thead=t.querySelector("thead"),this.wangEditorEditableContainer=e.getTargetParentElement(t,"w-e-text"),this.handshank=null,this.handshankCls="tableMergeCell-handshank",this.subline="tableMergeCell-subline",this.handshankHover="tableMergeCell-handshank-hover",this.average=200,this.init()}return Object(R["a"])(e,null,[{key:"getTargetParentElement",value:function(e,t){while(e.className&&!e.className.includes(t)&&e.parentNode)e=e.parentNode;return e}}]),Object(R["a"])(e,[{key:"init",value:function(){if(!this.tableEle||1!==this.tableEle.ELEMENT_NODE||"TABLE"!==this.tableEle.tagName)throw new Error("请传入table元素！");this.initTable(),this.handleExcelTable(),this.initTheadAndColgroup(),this.updateAverage(),this.setColWidth(),this.handleTableWidth(),this.handleResizeHandShank(),this.triggerFirstCellHeight(),this.addEvent()}},{key:"initTable",value:function(){this.tableEle.removeAttribute("width");var e=this.tableEle.parentNode;e&&e.className.includes("tableMergeCell-tempContainer")&&e.insertAdjacentElement("beforebegin",this.tableEle);var t=this.tableEle.nextElementSibling;t&&t.className&&t.className.includes("tableMergeCell-tempContainer")&&t.remove()}},{key:"handleExcelTable",value:function(){var e=this.tableEle.getAttribute("cellpadding");e||(this.colgroup&&(this.colgroup.remove(),this.colgroup=null),this.isExcelTable=!0,this.tableEle.setAttribute("cellpadding",0))}},{key:"initTheadAndColgroup",value:function(){var e=this.tableEle.tBodies[0],t=e.rows,n=t[0].childElementCount;if(this.colgroup&&this.colgroup.children&&this.colgroup.children.length!==n&&(this.colgroup.remove(),this.colgroup=null),!this.colgroup){for(var l=document.createElement("colgroup"),a=0;a<n;a++){var i=document.createElement("col");l.appendChild(i)}this.colgroup=e.insertAdjacentElement("beforebegin",l)}if(!this.thead){var r=document.createElement("thead"),o=document.createElement("tr");o.className="tableMergeCell-handshank-container";for(var s=0;s<n;s++){var c=document.createElement("th");o.appendChild(c)}r.appendChild(o),this.thead=e.insertAdjacentElement("beforebegin",r)}}},{key:"updateAverage",value:function(){if(this.isExcelTable){var e=this.opts.colMinWidth,t=this.colgroup.children,n=t[0];this.average=Math.max(n.getBoundingClientRect().width,2*e)}else{var l=this.wangEditorEditableContainer.clientWidth-20,a=this.tableEle.tBodies[0].rows;this.colCount=a[0].childElementCount,this.average=Math.floor(l/this.colCount)}}},{key:"setColWidth",value:function(){var e=this,t=this.colgroup.children;t.forEach((function(t){var n=t.style.width;n||(t.style.width="".concat(e.average,"px"))}))}},{key:"handleTableWidth",value:function(){if(!this.tableEle.style.width){var e=500;e=this.isExcelTable?Math.floor(this.tableEle.getBoundingClientRect().width):this.average*this.colCount,this.setTableWidth(e)}}},{key:"handleResizeHandShank",value:function(){var e=this,t=this.thead.children[0].children;t.forEach((function(t,n){var l=t.querySelector(".".concat(e.handshankCls));l&&l.remove();var a='<i data-col="'.concat(n,'" contenteditable="false" class="').concat(e.handshankCls,'"></i>');t.insertAdjacentHTML("beforeend",a)}))}},{key:"triggerFirstCellHeight",value:function(){var e=this;setTimeout((function(){var t=new CustomEvent("input",{bubbles:!0,cancelable:!1});e.tableEle.dispatchEvent(t)}),1e3)}},{key:"addOneCol",value:function(e){var t=this.colgroup.children,n=this.thead.children[0].children,l=document.createElement("col"),a=document.createElement("th");l.style.width="".concat(this.average,"px"),t[e].insertAdjacentElement("beforebegin",l),n[e].insertAdjacentElement("beforebegin",a)}},{key:"handleDelCol",value:function(e){var t=this.colgroup.children,n=this.thead.children[0].children;t[e].remove(),n[e].remove(),this.handleResizeHandShank();var l=this.getColsWidth();this.setTableWidth(l)}},{key:"addSubline",value:function(){this.handshank.classList.add(this.subline)}},{key:"setTableWidth",value:function(e){if("number"!==typeof e)throw new Error("表格宽的参数为Number类型！");e=e.toFixed(),this.tableEle.style.width="".concat(e,"px")}},{key:"getColsWidth",value:function(){var e=this.colgroup.children,t=Array.from(e).map((function(e){var t=e.style.width;return Number.parseInt(t)})),n=t.reduce((function(e,t){return e+t}));return n}},{key:"destroy",value:function(){this.removeEvent()}},{key:"addEvent",value:function(){window.addEventListener("mousedown",this.mousedown,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseup",this.mouseup,!1),this.wangEditorEditableContainer.addEventListener("input",this.input,!1)}},{key:"removeEvent",value:function(){window.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("mousemove",this.mousemove,!1),window.removeEventListener("mouseup",this.mouseup,!1),this.wangEditorEditableContainer.removeEventListener("input",this.input,!1)}}]),e}(),q=(n("1e51"),{mounted:function(){var e=this;this.$nextTick((function(){e.addInsertTableIconlistener(),window.addEventListener("keydown",e.tableObserve,!0),e.textElem=window.editor.$textElem.elems[0],e.textElem.addEventListener("paste",e.pasteTable,!0),window.addEventListener("copy",e.copy,!1),window.addEventListener("mousedown",e.mousedown,!0)}))},watch:{value:function(e){var t=this;if(e){if(!/<table[\s\S]*><\/table>/g.test(e))return;this.$nextTick((function(){t.initTableInteraction()}))}}},methods:{copy:function(){var e=window.getSelection().toString();e&&(console.log("监听整个表格复制命令（document.execCommand()），清空拷贝的单元格数据"),B.copyedCellsArray=[])},mousedown:function(e){var t=e.target;this.$refs.editor&&!this.$refs.editor.contains(t)&&this.removeTableActiveCls()},removeTableActiveCls:function(){var e=document.querySelectorAll(".tableMergeCell_active");e&&e.forEach((function(e){e.classList.remove("tableMergeCell_active")}))},pasteTable:function(e){var t=e.clipboardData||window.clipboardData,n=t.getData("text");console.log("textElem listen pasteTable event",n.length," "===n);var l=function(e){var t=e.items,n=e.types,l=null;console.log(t,n);for(var a=0;a<n.length;a++)if(console.log(t[a]),"Files"===n[a]){l=t[a];break}return l},a=l(t);if(" "===n){console.log("粘贴整个表格"),e.stopPropagation(),e.preventDefault();var i=window.localStorage.getItem("tableMergeCell_active")||"";if(!i.includes("tableMergeCell_active"))return;var r=document.createElement("div");r.insertAdjacentHTML("beforeend",i);var o=r.firstElementChild,s=window.getSelection();if(!s.rangeCount)return!1;var c=s.getRangeAt(0);c.insertNode(o),this.removeTableActiveCls(),s.collapseToEnd();var d=function(e){while("P"!==e.tagName&&e.parentNode)e=e.parentNode;return e},h=d(o);if(!h||"P"!==h.tagName)return;h.insertAdjacentElement("afterend",o)}else a&&"file"===a.kind&&a.type.match(/^image\//i)&&e.stopPropagation()},initTableInteraction:function(){if(!this.$refs.editor)throw new Error('请为wangEditor富文本容器元素提供ref="editor"属性');var e=function(e){while(e&&e.parentNode&&"TABLE"!==e.parentNode.tagName)e=e.parentNode;return e.parentNode};this.tables=this.$refs.editor.querySelectorAll(".w-e-text table"),this.tables.forEach((function(t){e(t)||(t.tableMergeCellInstance||(t.tableMergeCellInstance=new B(t,{onAddCol:function(e){t.tableColumnResizerInstance.handleAddCol(e)},onDelCol:function(e){t.tableColumnResizerInstance.handleDelCol(e)}})),t.tableColumnResizerInstance||(t.tableColumnResizerInstance=new D(t)))}))},addInsertTextListener:function(){this.insertText=this.iconTable.querySelector("button.right"),this.insertText&&this.insertText.addEventListener("click",this.initTableInteraction,!1)},addInsertTableIconlistener:function(){this.iconTable=document.querySelector(".w-e-menu[data-title='表格']"),this.iconTable&&this.iconTable.addEventListener("click",this.addInsertTextListener,!1)},tableObserve:function(){var e=this,t=function(t){var n=!0,l=!1,a=void 0;try{for(var i,r=t[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var o=i.value,s=o.target,c=o.addedNodes,d=Object(I["a"])(c,1),h=d[0];s.className.includes("w-e-text")&&h&&"TABLE"===h.tagName&&e.initTableInteraction()}}catch(u){l=!0,a=u}finally{try{n||null==r.return||r.return()}finally{if(l)throw a}}},n=new MutationObserver(t),l=this.$refs.editor.querySelector('.w-e-text[contenteditable="true"]');n.observe(l,{childList:!0,subtree:!0})}},beforeDestroy:function(){this.tables&&this.tables.forEach((function(e){e.tableMergeCellInstance&&(e.tableMergeCellInstance.destroy(),e.tableMergeCellInstance=null),e.tableColumnResizerInstance&&(e.tableColumnResizerInstance.destroy(),e.tableColumnResizerInstance=null)})),this.tables=null,this.iconTable&&this.iconTable.removeEventListener("click",this.addInsertTextListener,!1),this.insertText&&this.insertText.removeEventListener("click",this.initTableInteraction,!1),window.removeEventListener("keydown",this.tableObserve,!0),this.textElem.removeEventListener("paste",this.pasteTable,!0),window.removeEventListener("copy",this.copy,!1),window.removeEventListener("mousedown",this.mousedown,!0)}}),W=n("8b83"),F=n("c65a"),z=n("c03e"),X=function(e){function t(e){Object(N["a"])(this,t);var n=L.a.$('<div class="w-custom-menu" data-title="新增公式参数">\n                <i>新增公式参数</i>\n            </div>\n            ');return Object(W["a"])(this,Object(F["a"])(t).call(this,n,e))}return Object(z["a"])(t,e),Object(R["a"])(t,[{key:"clickHandler",value:function(){var e=new CustomEvent("addFormula");window.dispatchEvent(e)}},{key:"tryChangeActive",value:function(){this.active()}}]),t}(L.a.BtnMenu),V={name:"about",mixins:[q],components:{FormulaPop:A},data:function(){return{value:"",visible:!1,latex:"",type:"add"}},created:function(){var e=this;setTimeout((function(){e.value="\n                \n            "}),1e3),this.latexArray=[{latex:"\\frac{1}{2}"},{latex:"\\sqrt{2}"},{latex:"\\frac{32}{123}+x_{aa4}"}]},mounted:function(){this.initEditor(),this.listenMenuClick()},beforeDestroy:function(){window.removeEventListener("addFormula",this.addMath,!0)},methods:{latexToHtml:function(e){var t=window.$&&window.$("<span></span>").mathquill("editable").mathquill("write",e).mathquill("html");return'<span class="mathquill-rendered-math">'.concat(t,"</span>")},addMath:function(){this.type="add",this.latex="",this.visible=!0},editMath:function(e,t){this.type="edit",this.latex=e,this.currentIndex=t,this.visible=!0},confirm:function(e){if("add"===this.type){console.log("add");var t=window.$("<span></span>").mathquill("editable").mathquill("write",e).mathquill("html");t='<span contenteditable="false" class="mathquill-rendered-math">'.concat(t,"</span>");var n=this.editor.selection.getRange();n.insertNode($(t).get(0)),n.collapse(),this.latexArray.push({latex:e})}else"edit"===this.type&&(console.log("edit"),this.latexArray[this.currentIndex].latex=e)},getHtml:function(){this.newHtml=this.editor.txt.html(),this.$refs.newHtml.innerHTML=this.newHtml},setHtml:function(){this.editor.txt.html(this.newHtml)},initEditor:function(){this.editor=new L.a(this.$refs.editor),window.editor||(window.editor=this.editor);var e="alertMenuFormulaKey";this.editor.menus.extend(e,X),this.editor.config.menus=this.editor.config.menus.concat(e),this.editor.config.onchangeTimeout=200,this.editor.config.zIndex=9,this.editor.create()},listenMenuClick:function(){window.addEventListener("addFormula",this.addMath,!0)}}},G=V,U=(n("5795"),Object(r["a"])(G,h,u,!1,null,null,null)),J=U.exports;l["a"].use(d["a"]);var K=[{path:"/",name:"home",component:J}],Y=new d["a"]({routes:K}),Q=Y,Z=n("2f62");l["a"].use(Z["a"]);var ee=new Z["a"].Store({state:{},mutations:{},actions:{},modules:{}});l["a"].use(O["a"]),l["a"].prototype.$confirm=O["a"].confirm,l["a"].prototype.$info=O["a"].info,l["a"].config.productionTip=!1,new l["a"]({router:Q,store:ee,render:function(e){return e(c)}}).$mount("#app")},5795:function(e,t,n){"use strict";var l=n("6868"),a=n.n(l);a.a},"5c0b":function(e,t,n){"use strict";var l=n("9c0c"),a=n.n(l);a.a},6868:function(e,t,n){},"720a":function(e,t,n){},"9c0c":function(e,t,n){},be5c:function(e,t,n){"use strict";var l=n("07f7"),a=n.n(l);a.a}});
//# sourceMappingURL=app.6bee163b.js.map