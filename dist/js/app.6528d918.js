(function(e){function t(t){for(var l,r,o=t[0],s=t[1],c=t[2],h=0,u=[];h<o.length;h++)r=o[h],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&u.push(a[r][0]),a[r]=0;for(l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l]);d&&d(t);while(u.length)u.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],l=!0,o=1;o<n.length;o++){var s=n[o];0!==a[s]&&(l=!1)}l&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var l={},a={app:0},i=[];function r(t){if(l[t])return l[t].exports;var n=l[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=l,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)r.d(n,l,function(t){return e[t]}.bind(null,l));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"07f7":function(e,t,n){},"1e51":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var l=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("router-link",{attrs:{to:"/"}},[e._v("tableMergeCell")])],1),n("router-view")],1)},i=[],r=(n("5c0b"),n("2877")),o={},s=Object(r["a"])(o,a,i,!1,null,null,null),c=s.exports,d=n("8c4f"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"editor"},[n("div",{domProps:{innerHTML:e._s(e.value)}})]),n("formula-pop",{attrs:{visible:e.visible,type:e.type,latex:e.latex},on:{"update:visible":function(t){e.visible=t},confirm:e.confirm}}),n("table",{staticClass:"testTable"},[e._m(0),e._l(e.latexArray,(function(t,l){return n("tr",{key:l},[n("td",{domProps:{innerHTML:e._s(e.latexToHtml(t.latex))}}),n("td",{on:{click:function(n){return e.editMath(t.latex,l)}}},[e._v("编辑")])])}))],2)],1)},u=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",[n("th",[e._v("公式")]),n("th",[e._v("操作")])])}],m=(n("99af"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{attrs:{title:"新增公式",width:"600px",visible:e.visible},on:{ok:e.ok,cancel:e.cancel}},[e.visible?n("math-formula",{attrs:{type:e.type,latex:e.latex}}):e._e()],1)}),v=[],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"mathFormula"},[n("div",{staticClass:"tabMenu"},[n("ul",{staticClass:"tabTitle"},e._l(e.tabTitle,(function(t,l){return n("li",{key:l,class:{current:l===e.currentIndex},on:{click:function(t){return e.toggle(l)}}},[e._v(" "+e._s(t)+" ")])})),0),n("ul",{staticClass:"tabContent"},e._l(e.currentMathSymbol,(function(t,l){return n("li",{key:l,staticClass:"mathBox",style:e.bgPos(l),on:{click:function(n){return e.insert(t)}}})})),0)]),e._m(0)])},g=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mathDiv",attrs:{id:"mathDiv"}},[n("span",{attrs:{id:"jmeMath"}})])}],p=(n("45fc"),n("ac1f"),n("5319"),["常用公式","字母","符号"]),b=[["{/}frac{}{}","^{}/_{}","x^{}","x_{}","x^{}_{}","{/}bar{}","{/}sqrt{}","{/}nthroot{}{}","{/}sum^{}_{n=}","{/}sum","{/}log_{}","{/}ln","{/}int_{}^{}","{/}oint_{}^{}"],["{/}alpha","{/}beta","{/}gamma","{/}delta","{/}varepsilon","{/}varphi","{/}lambda","{/}mu","{/}rho","{/}sigma","{/}omega","{/}Gamma","{/}Delta","{/}Theta","{/}Lambda","{/}Xi","{/}Pi","{/}Sigma","{/}Upsilon","{/}Phi","{/}Psi","{/}Omega"],["+","-","{/}pm","{/}times","{/}ast","{/}div","/","{/}bigtriangleup","=","{/}ne","{/}approx",">","<","{/}ge","{/}le","{/}infty","{/}cap","{/}cup","{/}because","{/}therefore","{/}subset","{/}supset","{/}subseteq","{/}supseteq","{/}nsubseteq","{/}nsupseteq","{/}in","{/}ni","{/}notin","{/}mapsto","{/}leftarrow","{/}rightarrow","{/}Leftarrow","{/}Rightarrow","{/}leftrightarrow","{/}Leftrightarrow"]],y=[{x:0,y:272},{x:0,y:170},{x:0,y:0}],w={name:"MathFormula",props:{latex:{type:String,default:""},type:{type:String,default:"add",validator:function(e){return["add","edit"].some((function(t){return t===e}))}}},data:function(){return{currentIndex:0}},computed:{currentMathSymbol:function(){return this.mathSymbol[this.currentIndex]}},created:function(){this.tabTitle=p,this.mathSymbol=b},mounted:function(){var e=this;this.$nextTick((function(){window.$("#jmeMath").mathquill("editable").mathquill("write",e.latex)}))},methods:{toggle:function(e){this.currentIndex=e},bgPos:function(e){var t=34,n=y[this.currentIndex],l=n.x,a=n.y;return{backgroundPosition:"-".concat(l+Math.floor(e%8)*t,"px -").concat(a+Math.floor(e/8)*t,"px")}},insert:function(e){window.$("#jmeMath").focus().mathquill("write",e.replace("{/}","\\"))}}},C=w,E=(n("be5c"),Object(r["a"])(C,f,g,!1,null,null,null)),k=E.exports,x={name:"FormulaPop",components:{MathFormula:k},props:{visible:{type:Boolean,default:!1},latex:{type:String,default:""},type:{type:String,default:"add"}},methods:{ok:function(){var e=window.$("#jmeMath"),t=e.mathquill("latex");this.$emit("confirm",t),this.$emit("update:visible",!1)},cancel:function(){this.$emit("update:visible",!1)}}},M=x,T=Object(r["a"])(M,m,v,!1,null,null,null),A=T.exports,S=n("6fad"),I=n.n(S),L=(n("a4d3"),n("e01a"),n("d28b"),n("4160"),n("caad"),n("d3b7"),n("2532"),n("3ca3"),n("466d"),n("159b"),n("ddb0"),n("a630"),n("0d03"),n("b0c0"),n("a9e3"),n("c35a"),n("25eb"),n("25f0"),n("284c")),N=n("9f12"),R=n("53fe"),_=n("2fa7"),P=n("ed3b"),j=(n("cd09"),[{name:"靠左",key:"textAlignLeft"},{name:"居中",key:"textAlignCenter"},{name:"靠右",key:"textAlignRight"},{name:"设置背景色",key:"addBackgroundColor"},{name:"删除背景色",key:"delBackgroundColor"},{name:"合并单元格",key:"merge"},{name:"取消合并单元格",key:"unMerge"},{name:"添加行",key:"addRow"},{name:"删除行",key:"delRow"},{name:"添加列",key:"addCol"},{name:"删除列",key:"delCol"},{name:"设置表头",key:"addTh"},{name:"取消表头",key:"delTh"},{name:"复制表格",key:"copyTable"},{name:"删除表格",key:"delTable"}]),O=(n("1276"),function(e){var t=e.innerHTML;e.innerHTML=t.replace(/(&nbsp;){3,}/g,"<br>")}),B=function(e){for(var t=e.cells,n=t.length,l=0,a=0;a<n;a++){var i=t[a],r=i.getAttribute("colspan");l+=r>1?1*r:1}return l},D=function(e){var t=e.getAttribute("cellpadding");if(!t)for(var n=e.tBodies[0],l=n.children,a=l.length,i=B(l[0]),r=0;r<a;r++)for(var o=l[r],s=o.cells,c=0;c<i;c++){var d=s[c];O(d);var h=d.getAttribute("rowspan"),u=d.getAttribute("colspan");if(h>1&&!u)for(var m=1;m<h;m++){var v=l[r+m].insertCell(c);v.style.display="none"}else if(!h&&u>1)for(var f=1;f<u;f++){var g=o.insertCell(c+f);g.style.display="none"}else if(h>1&&u>1)for(var p=0;p<h;p++){var b=0,y=c;for(0===p&&(b=1,y=c+1);b<u;b++){var w=l[r+p].insertCell(y);w.style.display="none"}}}},H=function(e){var t=e.getAttribute("cellspacing");if(t){for(var n=e.tBodies[0],l=n.children,a=l[0],i=a.children,r=i.length,o=document.createDocumentFragment(),s=0;s<r;s++){var c=i[s];if("TD"===c.tagName){o=null;break}var d=document.createElement("td");o.appendChild(d)}if(o){var h=document.createElement("tr");h.appendChild(o),n.replaceChild(h,a)}}},q=function(){var e=document.querySelector(".tableMergeCell_active");e&&e.classList.remove("tableMergeCell_active")},W=function(e,t,n){if(!e)throw new Error("请传入行");if("number"!==typeof t||"number"!==typeof n)throw new Error("请传入行和列索引");if(t>0){var l=t-1,a=e[l].children[n];while(l>0&&a&&"none"===a.style.display)l--,a=e[l].children[n];return{preTrCell:a,preTrIndex:l}}},F=function(e,t){if(!e)throw new Error("请传入单元格");if("number"!==typeof t)throw new Error("请传入列索引");if(!e.previousElementSibling)return{preCell:e,preCellIndexRight:t};var n=e.previousElementSibling,l=t-1;while(l>0&&n&&"none"===n.style.display)n=n.previousElementSibling,l--;if(n){var a=G(n),i=a.colspan;l+=i-1}return{preCell:n,preCellIndexRight:l}},z=function(e,t,n,l){for(var a=n-1;a>=0;a--)for(var i=e[a].children,r=i.length,o=0;o<r;o++){var s=i[o],c=G(s),d=c.rowspan,h=c.colspan,u=a+d-1,m=o+h-1;if(d>1&&u>=n&&o<=l&&m>=l)return a}return n},X=function(e,t,n,l){for(var a=e[n].children,i=a.length,r=0;r<i;r++){var o=a[r],s=G(o),c=s.colspan,d=r+c-1;if(c>1&&d>=l&&r<=l)return r}return l},G=function(e){if(!e)return{rowspan:1,colspan:1};var t=e.getAttribute("rowspan"),n=e.getAttribute("colspan");return t=t?1*t:1,n=n?1*n:1,{rowspan:t,colspan:n}},J=function e(t,n,l,a,i){if(0===n)return n;for(var r=t[n].children,o=a;o<=i;o++){var s=r[o];if("none"===s.style.display){var c=z(t,s,n,o);if(c<n)return n=c,e(t,n,l,a,i)}}return n},U=function e(t,n,l,a,i){if(l===t.length-1)return l;for(var r=t[l].children,o=a;o<=i;o++){var s=r[o],c=G(s),d=c.rowspan;if(d>1)return l+=d-1,e(t,n,l,a,i);if(l>0&&"none"===s.style.display){var h=W(t,l,o),u=h.preTrCell,m=h.preTrIndex,v=G(u),f=v.rowspan;if(f>1){var g=m+f-1;if(g>l)return l=g,e(t,n,l,a,i)}}}return l},K=function e(t,n,l,a,i){if(0===a)return a;for(var r=n;r<=l;r++){var o=t[r],s=o.children,c=s[a];if("none"===c.style.display){var d=X(t,c,r,a);if(d<a)return a=d,e(t,n,l,a,i)}}return a},Y=function e(t,n,l,a,i){if(i===t[0].length)return i;for(var r=n;r<=l;r++){var o=t[r],s=o.children,c=s[i],d=G(c),h=d.colspan;if(h>1)return i+=h-1,e(t,n,l,a,i);if("none"===c.style.display){var u=F(c,i),m=u.preCell,v=u.preCellIndexRight,f=G(m),g=f.colspan;if(g>1&&i<v)return i=v,e(t,n,l,a,i)}}return i},Q=function(e){var t=document.createElement("span");t.style.color=e,document.body.appendChild(t);var n=window.getComputedStyle(t).color;return document.body.removeChild(t),n},V=function(){return{row:-1,col:-1}},Z=function(e){while("TD"!==e.tagName&&"TH"!==e.tagName&&e.parentNode)e=e.parentNode;return e},ee=function(e){e=e.replace(/\n/g,"n").replace(/\s/g,",").replace(/,{2,}/g,","),e=e.substring(0,e.length-2);var t=e.split(",n"),n=[];return t.forEach((function(e){var t=e.split(",");n.push(t)})),n},te=function(e){for(var t=e.addedNodes,n=null,l=0;l<t.length;l++){var a=t[l],i=a.className;if("TABLE"===a.tagName){n=a;break}if(i&&i.includes("tableMergeCell-tempContainer")){n=a.firstChild;break}}return n},ne=function(e){for(var t=e.addedNodes,n=null,l=0;l<t.length;l++){var a=t[l];if("IMG"===a.tagName){var i=a.previousElementSibling;if(i&&"TABLE"===i.tagName){n=a.getAttribute("src");break}if(a.parentNode){var r=a.parentNode.previousElementSibling;if(r&&"TABLE"===r.tagName){n=a.getAttribute("src");break}}}}return n},le={btnDisabledColor:"#ddd",onAddCol:null,onDelCol:null,imgMinWidth:20},ae=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(N["a"])(this,e),Object(_["a"])(this,"colorChange",(function(e){var t=e.target,l=t.value,a=n.colorPicker.selectedCells;a.length&&a.forEach((function(e){e.style.backgroundColor=l})),n.colorPicker&&(n.colorPicker.removeEventListener("input",n.colorChange),n.colorPicker.remove(),n.colorPicker=null),n.removeClass()})),Object(_["a"])(this,"menuClick",(function(e){var t=e.target,l=window.getComputedStyle(t).color,a=Q(n.opts.btnDisabledColor);if(l!==a){var i=t.dataset.key,r=n.getCellIndex(n.contextmenuCell),o=r.row,s=r.col;switch(i){case"copyTable":n.copyTable();break;case"textAlignLeft":n.textAlignLeft();break;case"textAlignCenter":n.textAlignCenter();break;case"textAlignRight":n.textAlignRight();break;case"addBackgroundColor":n.addBackgroundColor();break;case"delBackgroundColor":n.delBackgroundColor();break;case"delTable":n.delTable();break;case"addRow":n.addRow(o);break;case"delRow":n.delRow(o);break;case"addCol":n.addCol(s);break;case"delCol":n.delCol(s);break;case"addTh":n.addTh();break;case"delTh":n.delTh();break;case"merge":n.mergeCell();break;case"unMerge":n.unMergeCell();break}n.menuEle&&(n.menuEle.style.display="none")}})),Object(_["a"])(this,"mousedown",(function(e){var t=e.target,l=e.button;if(0===l&&"IMG"!==t.tagName&&(!n.imgMasklayer||!n.imgMasklayer.contains(t))&&n.tBody.contains(t)&&!n.tableIsInTable(t)){t=Z(t);var a=t,i=a.tagName;"TD"!==i&&"TH"!==i||(n.ready=!0,n.cellStart=t,n.indexStart=n.getCellIndex(t),n.removeClass(),n.addClass(t))}})),Object(_["a"])(this,"removeSomeNoSelfIsClicked",(function(e){var t=e.target;n.menuEle&&!n.menuEle.contains(t)&&(n.menuEle.style.display="none");var l=t.dataset.key;!t||n.tableEle.contains(t)||"addBackgroundColor"===l||t.className.includes("tableMergeCell-contextmenu")||n.removeClass(),n.colorPicker&&n.colorPicker.remove(),n.imgMasklayer&&!n.imgMasklayer.contains(t)&&(n.imgMasklayer.removeEventListener("click",n.handleImgBtn,!1),n.imgMasklayer.removeEventListener("keydown",n.handleImgEnter,!1),n.imgMasklayer.insertAdjacentElement("beforebegin",n.selectedImg),n.imgMasklayer.remove()),t&&!n.tableEle.contains(t)&&q()})),Object(_["a"])(this,"mousemove",(function(e){var t=e.target,l=e.button;t=Z(t),0===l&&n.ready&&n.tBody.contains(t)&&window.requestAnimationFrame((function(){n.cellEnd=t,n.indexEnd=n.getCellIndex(t);var e=window.getSelection();n.cellStart!==n.cellEnd&&e.collapseToEnd()}))})),Object(_["a"])(this,"mouseup",(function(e){var t=e.target,l=e.button;0===l&&n.ready&&(t=Z(t),n.tBody.contains(t)&&(n.cellEnd=t,n.indexEnd=n.getCellIndex(t),n.addClass(t),n.makeSelectedCellsToRect()),n.ready=!1)})),Object(_["a"])(this,"tableClick",(function(e){var t=e.target,l=e.button,a=t.tagName;if(0===l&&n.tableEle.contains(t)&&e.stopPropagation(),"A"===a){var i=t.getAttribute("href");window.open(i)}"IMG"===a&&n.handleImg(t)})),Object(_["a"])(this,"contextmenu",(function(e){var t=e.target,l=e.clientX,a=e.clientY;if("IMG"!==t.tagName&&(e.preventDefault(),!n.tableIsInTable(t))){if(!n.menuEle){n.menuEle=document.createElement("ul"),n.menuEle.classList.add("tableMergeCell-contextmenu"),n.menuEle.addEventListener("click",n.menuClick,!1),n.menus.forEach((function(e){var t=document.createElement("li"),l=e.name,a=e.key;t.textContent=l,t.dataset.key=a,n["btn_".concat(a)]=t,n.menuEle.appendChild(t)})),document.body.appendChild(n.menuEle);var i=n.menuEle.getBoundingClientRect(),r=i.width,o=i.height;n.menuEle.dataset.width=r,n.menuEle.dataset.height=o}var s=document.documentElement,c=s.clientWidth,d=s.clientHeight,h=n.menuEle.dataset,u=h.width,m=h.height,v=c-l,f=d-a;n.menuEle.style.marginLeft=v<u?"-".concat(u,"px"):"auto",n.menuEle.style.marginTop=f<m?"-".concat(m,"px"):"auto",n.menuEle.style.top="".concat(a,"px"),n.menuEle.style.left="".concat(l,"px"),n.menuEle.style.display="block",n.contextmenuCell=Z(t),n.handleSomeMenuBtns(t)}})),Object(_["a"])(this,"copy",(function(t){var l=window.getSelection().toString(),a=n.isActiveTable(),i=n.getSelectedCells(!0);q(),l?t.stopPropagation():a?n.copyTable():Array.isArray(i)&&(t.stopPropagation(),t.preventDefault(),t.clipboardData?t.clipboardData.setData("text/plain",""):window.clipboardData&&window.clipboardData.setData("text",""),e.copyedCellsArray=i)})),Object(_["a"])(this,"paste",(function(t){var l=t.clipboardData||window.clipboardData,a=l.getData("text");if(l.items.length>2){t.preventDefault(),t.stopPropagation();var i=ee(a);n.handlePaste(i)}else e.copyedCellsArray.length&&(a||(t.preventDefault(),n.handlePaste(e.copyedCellsArray),n.indexStart=V(),n.indexEnd=V()))})),Object(_["a"])(this,"keydown",(function(e){var t=e.key;if("Delete"===t){var l=n.tableEle.querySelectorAll(".tableMergeCell-selected");l.forEach((function(e){e.innerHTML=""}))}})),Object(_["a"])(this,"handleImgEnter",(function(e){var t=e.key,l=e.target;"Enter"===t&&l.className.includes("tableMergeCell-imgInput")&&n.handleImgWidth(l)})),Object(_["a"])(this,"handleImgBtn",(function(e){var t=e.target;if(t.className.includes("tableMergeCell-imgBtn")){var l=t.previousElementSibling;n.handleImgWidth(l)}})),this.opts=Object.assign({},le,l),this.tableEle=t,this.tBody=t.tBodies[0],this.rows=this.tBody.rows,this.tableClassName="tableMergeCell",this.menuEle=null,this.menus=j,this.selectedCellClassName="tableMergeCell-selected",this.ready=!1,this.cellStart=null,this.cellEnd=null,this.indexStart=V(),this.indexEnd=V(),this.maxRowCount=0,this.maxColCount=0,this.contextmenuCell=null,this.init()}return Object(R["a"])(e,[{key:"init",value:function(){if(!this.tableEle&&1!==this.tableEle.ELEMENT_NODE&&"TABLE"!==this.tableEle.tagName)throw new Error("请传入table元素！");this.tableEle.classList.add(this.tableClassName),this.syncMaxRowAndColCount(),this.addEvent()}},{key:"destroy",value:function(){this.removeEvent(),this.menuEle&&(this.menuEle.removeEventListener("click",this.menuClick,!1),this.menuEle.remove())}},{key:"addCellLocation",value:function(){var e=this.rows;e.forEach((function(e,t){var n=e.children;n.forEach((function(e,n){e.textContent=t+"-"+n}))}))}},{key:"syncMaxRowAndColCount",value:function(){var e=this.rows;e.length?(this.maxRowCount=e.length,this.maxColCount=e[0].childElementCount):(this.maxRowCount=0,this.maxColCount=0)}},{key:"addBackgroundColor",value:function(){var e=this,t=this.getSelectedCells();if(t.length){this.colorPicker=document.createElement("input"),this.colorPicker.setAttribute("type","color"),this.colorPicker.className="tableMergeCell-colorPicker",this.colorPicker.addEventListener("input",this.colorChange,!1),this.colorPicker.selectedCells=t;var n=t[t.length-1];n.appendChild(this.colorPicker),setTimeout((function(){e.colorPicker.click()}),20)}}},{key:"delBackgroundColor",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.removeProperty("background-color")}))}},{key:"tableIsInTable",value:function(e){while(e&&"TABLE"!==e.tagName)e=e.parentNode;return this.tableEle!==e&&this.tableEle.contains(e)}},{key:"addClass",value:function(e){e.className.includes(this.selectedCellClassName)||e.classList.add(this.selectedCellClassName)}},{key:"removeClass",value:function(e){var t=this;if(e)e.classList.remove(this.selectedCellClassName),""===e.className&&e.removeAttribute("class");else{var n=this.tableEle.querySelectorAll(".tableMergeCell-selected");n.length&&n.forEach((function(e){e.classList.remove(t.selectedCellClassName),""===e.className&&e.removeAttribute("class")}))}}},{key:"getSelectedCells",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexStart,n=this.indexEnd,l=[],a=[],i=this.rows,r=t.row;r<=n.row;r++){for(var o=i[r],s=o.children,c=[],d=t.col;d<=n.col;d++){var h=s[d];l.push(h),c.push(h)}c.length&&a.push(c)}return e?a:l}},{key:"mergeCell",value:function(){for(var e=this.rows,t=this.indexStart,n=this.indexEnd,l=e[t.row].children[t.col],a=t.row;a<=n.row;a++)for(var i=e[a],r=i.children,o=t.col;o<=n.col;o++){var s=r[o];if(s.innerText&&!l.innerText&&(l.innerHTML=s.innerHTML),a===t.row&&o===t.col){var c=n.row-t.row+1,d=n.col-t.col+1;s.setAttribute("rowspan",c),s.setAttribute("colspan",d)}else s.removeAttribute("rowspan"),s.removeAttribute("colspan"),s.style.display="none";this.removeClass(s)}}},{key:"unMergeCell",value:function(){for(var e=this.rows,t=this.indexStart,n=this.indexEnd,l=t.row;l<=n.row;l++)for(var a=e[l],i=a.children,r=t.col;r<=n.col;r++){var o=i[r];"none"===o.style.display?(o.style.removeProperty("display"),""===o.getAttribute("style")&&o.removeAttribute("style")):(o.removeAttribute("rowspan"),o.removeAttribute("colspan")),this.removeClass(o)}}},{key:"getCellIndex",value:function(e){for(var t={row:-1,col:-1},n=0;n<this.maxRowCount;n++){for(var l=this.rows[n],a=l.children,i=a.length,r=0;r<i;r++){var o=a[r];if(o===e){t.row=n,t.col=r;break}}if(t.row>0)break}return t}},{key:"getIsMergedCellBool",value:function(e){var t=G(e),n=t.rowspan,l=t.colspan,a=Math.max(n,l);return a>1}},{key:"getSelectedCellsByClassName",value:function(){return Array.from(this.tableEle.querySelectorAll(".".concat(this.selectedCellClassName)))}},{key:"getMergedRowIndexArray",value:function(e,t){var n=e+t-1,l=[];do{l.push(e),e++}while(e<=n);return l}},{key:"getMergedColIndexArray",value:function(e,t){var n=e+t-1,l=[];do{l.push(e),e++}while(e<=n);return l}},{key:"handleSomeMenuBtns",value:function(){var e=this.opts.btnDisabledColor,t=this.getSelectedCellsByClassName();this.cellStart&&this.cellEnd&&t.length?(this.btn_textAlignLeft.style.removeProperty("color"),this.btn_textAlignCenter.style.removeProperty("color"),this.btn_textAlignRight.style.removeProperty("color"),this.btn_addBackgroundColor.style.removeProperty("color"),this.btn_delBackgroundColor.style.removeProperty("color"),this.btn_addRow.style.removeProperty("color"),this.btn_delRow.style.removeProperty("color"),this.btn_addCol.style.removeProperty("color"),this.btn_delCol.style.removeProperty("color"),this.btn_addTh.style.removeProperty("color"),this.btn_delTh.style.removeProperty("color"),this.btn_merge.style.removeProperty("color"),this.btn_unMerge.style.removeProperty("color")):(this.btn_addBackgroundColor.style.color=e,this.btn_delBackgroundColor.style.color=e,this.btn_textAlignLeft.style.color=e,this.btn_textAlignCenter.style.color=e,this.btn_textAlignRight.style.color=e,this.btn_addRow.style.color=e,this.btn_delRow.style.color=e,this.btn_addCol.style.color=e,this.btn_delCol.style.color=e,this.btn_addTh.style.color=e,this.btn_delTh.style.color=e,this.btn_merge.style.color=e,this.btn_unMerge.style.color=e)}},{key:"handleMergedCellByDelCol",value:function(e){for(var t=this.rows,n=t.length,l=0;l<n;l++)for(var a=t[l],i=a.children,r=i.length,o=0;o<r;o++){var s=i[o],c=G(s),d=c.colspan;d>1&&e>o&&e<o+d&&s.setAttribute("colspan",d-1)}}},{key:"delTable",value:function(){this.tableEle.remove()}},{key:"delEmptyTable",value:function(){var e=this.rows;e.length&&e[0].children.length||this.delTable()}},{key:"addRow",value:function(e){var t=this,n=this.maxColCount,l=this.tBody,a=this.getRelatedMergedRowCells(e,"addRow"),i=[];a.forEach((function(e){var n=G(e),l=n.rowspan,a=n.colspan,r=t.getCellIndex(e),o=r.col;i.push.apply(i,Object(L["a"])(t.getMergedColIndexArray(o,a))),e.setAttribute("rowspan",l+1)}));for(var r=l.insertRow(e),o=0;o<n;o++)r.insertCell(o);i.forEach((function(e){r.children[e].style.display="none"})),this.syncMaxRowAndColCount()}},{key:"getRelatedMergedRowCells",value:function(e,t){var n=this,l=this.rows,a=[];return l.forEach((function(l,i){var r=l.children;r.forEach((function(l){var r=G(l),o=r.rowspan;o>1&&n.rowIsInMergedRow(i,o,e,t)&&a.push(l)}))})),a}},{key:"rowIsInMergedRow",value:function(e,t,n,l){return"addRow"===l?n>e&&n<=e+t-1:"delRow"===l?n>=e&&n<=e+t-1:void 0}},{key:"addCol",value:function(e){var t=this.opts.onAddCol;this.syncMaxRowAndColCount();for(var n=this.maxRowCount,l=this.rows,a=0;a<n;a++){var i=l[a],r=i.children[e];r.insertAdjacentHTML("beforebegin","<td></td>")}l.forEach((function(t,n){var a=t.children;a.forEach((function(t,i){var r=G(t),o=r.rowspan,s=r.colspan;if(s>1&&e>i&&e<=i+s-1){t.setAttribute("colspan",s+1),a[e].style.display="none";var c=o,d=n;while(c>1)l[++d].children[e].style.display="none",c--}}))})),this.syncMaxRowAndColCount(),t&&t(e)}},{key:"delRow",value:function(e){var t=this,n=this.tBody,l=this.rows,a=this.getRelatedMergedRowCells(e,"delRow");a.forEach((function(n){var a=t.getCellIndex(n),i=a.row,r=a.col;i===e?t.delFirstRow(l,r,n,e):t.delOtherRow(n)})),n.deleteRow(e),this.delEmptyTable(),this.syncMaxRowAndColCount()}},{key:"delOtherRow",value:function(e){var t=G(e),n=t.rowspan;e.setAttribute("rowspan",n-1)}},{key:"delFirstRow",value:function(e,t,n,l){var a=G(n),i=a.rowspan,r=a.colspan,o=e[l+1],s=o.children[t];s.setAttribute("rowspan",i-1),s.setAttribute("colspan",r),s.style.display="table-cell"}},{key:"getRelatedMergedColCells",value:function(e){var t=this.rows,n=[];return t.forEach((function(t){var l=t.children;l.forEach((function(t,l){var a=G(t),i=a.colspan;i>1&&e>=l&&e<=l+i-1&&n.push(t)}))})),n}},{key:"delOtherCol",value:function(e){var t=G(e),n=t.colspan;e.setAttribute("colspan",n-1)}},{key:"delFirstCol",value:function(e){var t=G(e),n=t.rowspan,l=t.colspan,a=e.nextElementSibling;a.setAttribute("colspan",l-1),a.setAttribute("rowspan",n),a.style.display="table-cell"}},{key:"delCol",value:function(e){var t=this,n=this.opts.onDelCol,l=this.rows,a=this.getRelatedMergedColCells(e);a.forEach((function(n){var l=t.getCellIndex(n),a=l.col;a===e?t.delFirstCol(n):t.delOtherCol(n)})),l.forEach((function(t){t.deleteCell(e)})),this.delEmptyTable(),this.syncMaxRowAndColCount(),n&&n(e)}},{key:"addTh",value:function(){for(var e=this.rows,t=this.indexStart.row;t<=this.indexEnd.row;t++)for(var n=e[t],l=n.children,a=this.indexStart.col;a<=this.indexEnd.col;a++){var i=l[a];i.style.borderBottom="2px solid #ccc",i.style.textAlign="center",i.style.backgroundColor="#f1f1f1",i.style.fontWeight="bold"}}},{key:"delTh",value:function(){for(var e=this.rows,t=this.indexStart.row;t<=this.indexEnd.row;t++)for(var n=e[t],l=n.children,a=this.indexStart.col;a<=this.indexEnd.col;a++){var i=l[a];"TH"===i.tagName?i.outerHTML=i.outerHTML.replace(/^<th>/,"<td>").replace(/<\/th>$/,"</td>"):(i.style.removeProperty("border-bottom"),i.style.removeProperty("text-align"),i.style.removeProperty("background-color"),i.style.removeProperty("font-weight"))}}},{key:"textAlignLeft",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="left"}))}},{key:"textAlignCenter",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="center"}))}},{key:"textAlignRight",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="right"}))}},{key:"copyTable",value:function(){if(this.removeClass(),q(),this.tableEle.classList.add("tableMergeCell_active"),window.localStorage.setItem("tableMergeCell_active",this.tableEle.outerHTML),this.tableEle.classList.contains("tableMergeCell_active")){var e=" ",t=document.createElement("INPUT");t.style.opacity=0,t.style.position="absolute",t.style.left="-100000px",document.body.appendChild(t),t.value=e,t.select(),t.setSelectionRange(0,e.length),document.execCommand("copy"),document.body.removeChild(t)}}},{key:"isActiveTable",value:function(){var e=this.rows,t=e[0],n=e[e.length-1],l=t.firstElementChild,a=n.lastElementChild;return l==this.cellStart&&a==this.cellEnd}},{key:"highlightRangeCells",value:function(){for(var e=this.rows,t=this.indexStart.row;t<=this.indexEnd.row;t++)for(var n=e[t],l=n.children,a=this.indexStart.col;a<=this.indexEnd.col;a++){var i=l[a];this.addClass(i)}}},{key:"handleIndexSerial",value:function(){var e=this.indexStart,t=e.row,n=e.col,l=this.indexEnd,a=l.row,i=l.col;t>a&&(this.indexStart.row=a,this.indexEnd.row=t),n>i&&(this.indexStart.col=i,this.indexEnd.col=n)}},{key:"updateIndex",value:function(){var e=this.rows,t=this.indexStart,n=this.indexEnd;this.indexStart.row=J(e,t.row,n.row,t.col,n.col),this.indexStart.col=K(e,t.row,n.row,t.col,n.col),this.indexEnd.row=U(e,t.row,n.row,t.col,n.col),this.indexEnd.col=Y(e,t.row,n.row,t.col,n.col)}},{key:"makeSelectedCellsToRect",value:function(){if(!(this.indexEnd.row<0||this.indexEnd.col<0)){this.handleIndexSerial();var e=1,t=10;while(e<=t){var n=this.indexStart,l=n.row,a=n.col,i=this.indexEnd,r=i.row,o=i.col;this.updateIndex(),this.indexStart.row===l&&this.indexEnd.row===r&&this.indexStart.col===a&&this.indexEnd.col===o&&(e=t),e++}this.highlightRangeCells()}}},{key:"handlePaste",value:function(e){if(!Array.isArray(e))throw new Error("请传入复制的单元格");for(var t=this.rows,n=0,l=this.indexStart.row;n<e.length;n++,l++){var a=e[n],i=t[l];if(!i)break;for(var r=i.children,o=0,s=this.indexStart.col;o<a.length;o++,s++){var c=a[o],d=r[s];if(d)if("string"!==typeof c){var h=d.style.display,u=c.style.display;h===u&&(d.innerHTML=c.innerHTML,d.setAttribute("style",c.getAttribute("style")))}else d.innerText=c}}}},{key:"handleImg",value:function(e){this.selectedImg=e;var t=this.selectedImg.getBoundingClientRect(),n=t.width,l=t.height;this.imgOriginWidth=n,this.selectedImg.insertAdjacentHTML("beforebegin",'\n            <div contenteditable="false" class="tableMergeCell-imgTooltip" style="width: '.concat(n,"px; height: ").concat(l,'px;">\n                <span class="tableMergeCell-imgInputWrap">\n                    <input value="').concat(n,'px" class="tableMergeCell-imgInput" title="调整图片至特定宽度">\n                    <button type="button" class="tableMergeCell-imgBtn">确定</button>\n                </span>\n            </div>')),this.imgMasklayer=this.tableEle.querySelector(".tableMergeCell-imgTooltip"),this.imgMasklayer.insertAdjacentElement("afterbegin",this.selectedImg),this.imgMasklayer&&(this.imgMasklayer.addEventListener("click",this.handleImgBtn,!1),this.imgMasklayer.addEventListener("keydown",this.handleImgEnter,!1))}},{key:"handleImgWidth",value:function(e){var t,n=e.value,l=this.opts.imgMinWidth;if(/^\d+/.test(n)?t=Number.parseInt(n):e.value="".concat(this.imgOriginWidth,"px"),t<l)P["a"]&&P["a"].confirm({title:"提示",content:"图片最小宽为".concat(l,"像素！"),zIndex:10009});else{var a=function(e){while("TD"!==e.tagName&&e.parentNode)e=e.parentNode;return e},i=a(this.imgMasklayer);if(i&&"TD"===i.tagName){var r=window.getComputedStyle(i),o=r.width,s=r.paddingRight,c=r.paddingLeft,d=r.borderRightWidth,h=Number.parseFloat(o)-Number.parseFloat(s)-Number.parseFloat(c)-Number.parseFloat(d);if(t>h)return void(P["a"]&&P["a"].confirm({title:"提示",content:"图片的宽不能超过单元格的宽，请先调整列宽到合适的宽度！",zIndex:10009}))}if("number"===typeof t&&t!==this.imgOriginWidth){this.selectedImg.style.width="".concat(t,"px");var u=this.selectedImg.getBoundingClientRect(),m=u.width,v=u.height;this.imgMasklayer.style.width="".concat(m,"px"),this.imgMasklayer.style.height="".concat(v,"px")}this.imgMasklayer&&(this.imgMasklayer.removeEventListener("click",this.handleImgBtn,!1),this.imgMasklayer.removeEventListener("keydown",this.handleImgEnter,!1),this.imgMasklayer.insertAdjacentElement("beforebegin",this.selectedImg),this.imgMasklayer.remove())}}},{key:"addEvent",value:function(){this.tableEle.addEventListener("mousedown",this.mousedown,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseup",this.mouseup,!1),this.tableEle.addEventListener("click",this.tableClick,!1),this.tableEle.addEventListener("contextmenu",this.contextmenu,!1),this.tableEle.addEventListener("copy",this.copy,!1),this.tableEle.addEventListener("paste",this.paste,!1),window.addEventListener("mousedown",this.removeSomeNoSelfIsClicked,!0),window.addEventListener("keydown",this.keydown,!0)}},{key:"removeEvent",value:function(){this.tableEle.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("mousemove",this.mousemove,!1),window.removeEventListener("mouseup",this.mouseup,!1),this.tableEle.removeEventListener("click",this.tableClick,!1),this.tableEle.removeEventListener("contextmenu",this.contextmenu,!1),this.tableEle.removeEventListener("copy",this.copy,!1),this.tableEle.removeEventListener("paste",this.paste,!1),window.removeEventListener("mousedown",this.removeSomeNoSelfIsClicked,!0),window.removeEventListener("keydown",this.keydown,!0)}}]),e}();Object(_["a"])(ae,"copyedCellsArray",[]);n("d81d"),n("13d5"),n("b680");var ie={colMinWidth:50},re=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(N["a"])(this,e),Object(_["a"])(this,"handleAddCol",(function(e){n.addOneCol(e),n.handleResizeHandShank();var t=n.getColsWidth();n.setTableWidth(t)})),Object(_["a"])(this,"mousedown",(function(e){var t=e.target,l=e.button,a=e.clientX;n.tableEle.contains(t)&&0===l&&t.className.includes(n.handshankCls)?(n.handshank=t,n.handshank.classList.add(n.handshankHover),n.clientX=a,n.addSubline()):n.handshank=null})),Object(_["a"])(this,"mousemove",(function(e){if(n.handshank){e.preventDefault();var t=e.clientX;n.diff=t-n.clientX,n.handshank.style.transform="translateX(".concat(n.diff,"px)")}})),Object(_["a"])(this,"mouseup",(function(e){if(n.handshank){var t=e.clientX,l=n.handshank.dataset.col,a=n.colgroup.children[l];if(a){var i=Number.parseInt(a.style.width),r=i+n.diff,o=n.opts.colMinWidth,s=Math.max(o,r);n.tableEle.contains(n.handshank)&&t-n.clientX!==0&&(a.style.width="".concat(s,"px"))}n.handshank.style.removeProperty("transform"),n.handshank.classList.remove(n.handshankHover,n.subline),n.handshank=null;var c=n.getColsWidth();n.setTableWidth(c)}})),Object(_["a"])(this,"input",(function(){var e=n.tableEle.tBodies[0],t=e.rows[0],l=t.children[0],a=l.getBoundingClientRect(),i=a.height,r=n.thead.children[0].children;i>30?r.forEach((function(e){var t=e.querySelector(".".concat(n.handshankCls));t&&(t.style.height="".concat(i,"px"))})):r.forEach((function(e){var t=e.querySelector(".".concat(n.handshankCls));t&&t.style.removeProperty("height")}))})),this.opts=Object.assign({},ie,l),this.isExcelTable=!1,this.tableEle=t,this.colgroup=t.querySelector("colgroup"),this.thead=t.querySelector("thead"),this.wangEditorEditableContainer=e.getTargetParentElement(t,"w-e-text"),this.handshank=null,this.handshankCls="tableMergeCell-handshank",this.subline="tableMergeCell-subline",this.handshankHover="tableMergeCell-handshank-hover",this.average=200,this.init()}return Object(R["a"])(e,null,[{key:"getTargetParentElement",value:function(e,t){while(e.className&&!e.className.includes(t)&&e.parentNode)e=e.parentNode;return e}}]),Object(R["a"])(e,[{key:"init",value:function(){if(!this.tableEle||1!==this.tableEle.ELEMENT_NODE||"TABLE"!==this.tableEle.tagName)throw new Error("请传入table元素！");this.initTable(),this.handleExcelTable(),this.initTheadAndColgroup(),this.updateAverage(),this.setColWidth(),this.handleTableWidth(),this.handleResizeHandShank(),this.triggerFirstCellHeight(),this.addEvent()}},{key:"initTable",value:function(){this.tableEle.removeAttribute("width");var e=this.tableEle.parentNode;e&&e.className.includes("tableMergeCell-tempContainer")&&e.insertAdjacentElement("beforebegin",this.tableEle);var t=this.tableEle.nextElementSibling;t&&t.className&&t.className.includes("tableMergeCell-tempContainer")&&t.remove()}},{key:"handleExcelTable",value:function(){var e=this.tableEle.getAttribute("cellpadding");e||(this.colgroup&&(this.colgroup.remove(),this.colgroup=null),this.isExcelTable=!0,this.tableEle.setAttribute("cellpadding",0))}},{key:"initTheadAndColgroup",value:function(){var e=this.tableEle.tBodies[0],t=e.rows,n=t[0].childElementCount;if(this.colgroup&&this.colgroup.children&&this.colgroup.children.length!==n&&(this.colgroup.remove(),this.colgroup=null),!this.colgroup){for(var l=document.createElement("colgroup"),a=0;a<n;a++){var i=document.createElement("col");l.appendChild(i)}this.colgroup=e.insertAdjacentElement("beforebegin",l)}if(!this.thead){var r=document.createElement("thead"),o=document.createElement("tr");o.className="tableMergeCell-handshank-container";for(var s=0;s<n;s++){var c=document.createElement("th");o.appendChild(c)}r.appendChild(o),this.thead=e.insertAdjacentElement("beforebegin",r)}}},{key:"updateAverage",value:function(){if(this.isExcelTable){var e=this.opts.colMinWidth,t=this.colgroup.children,n=t[0];this.average=Math.max(n.getBoundingClientRect().width,2*e)}else{var l=this.wangEditorEditableContainer.clientWidth-20,a=this.tableEle.tBodies[0].rows;this.colCount=a[0].childElementCount,this.average=Math.floor(l/this.colCount)}}},{key:"setColWidth",value:function(){var e=this,t=this.colgroup.children;t.forEach((function(t){var n=t.style.width;n||(t.style.width="".concat(e.average,"px"))}))}},{key:"getColTotal",value:function(){var e=this.colgroup.children,t=0;return e.forEach((function(e){var n=e.style.width;if(n){var l=Number.parseInt(n);"number"===typeof l&&(t+=l)}})),t}},{key:"handleTableWidth",value:function(){if(!this.tableEle.style.width){var e=500;if(this.isExcelTable){var t=this.getColTotal();e=t||Math.floor(this.tableEle.getBoundingClientRect().width)}else e=this.average*this.colCount;this.setTableWidth(e)}}},{key:"handleResizeHandShank",value:function(){var e=this,t=this.thead.children[0].children;t.forEach((function(t,n){var l=t.querySelector(".".concat(e.handshankCls));l&&l.remove();var a='<i data-col="'.concat(n,'" contenteditable="false" class="').concat(e.handshankCls,'"></i>');t.insertAdjacentHTML("beforeend",a)}))}},{key:"triggerFirstCellHeight",value:function(){var e=this;setTimeout((function(){var t=new CustomEvent("input",{bubbles:!0,cancelable:!1});e.tableEle.dispatchEvent(t)}),1e3)}},{key:"addOneCol",value:function(e){var t=this.colgroup.children,n=this.thead.children[0].children,l=document.createElement("col"),a=document.createElement("th");l.style.width="".concat(this.average,"px"),t[e].insertAdjacentElement("beforebegin",l),n[e].insertAdjacentElement("beforebegin",a)}},{key:"handleDelCol",value:function(e){var t=this.colgroup.children,n=this.thead.children[0].children;t[e].remove(),n[e].remove(),this.handleResizeHandShank();var l=this.getColsWidth();this.setTableWidth(l)}},{key:"addSubline",value:function(){this.handshank.classList.add(this.subline)}},{key:"setTableWidth",value:function(e){if("number"!==typeof e)throw new Error("表格宽的参数为Number类型！");e=e.toFixed(),this.tableEle.style.width="".concat(e,"px")}},{key:"getColsWidth",value:function(){var e=this.colgroup.children,t=Array.from(e).map((function(e){var t=e.style.width;return Number.parseInt(t)})),n=t.reduce((function(e,t){return e+t}));return n}},{key:"destroy",value:function(){this.removeEvent()}},{key:"addEvent",value:function(){window.addEventListener("mousedown",this.mousedown,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseup",this.mouseup,!1),this.wangEditorEditableContainer.addEventListener("input",this.input,!1)}},{key:"removeEvent",value:function(){window.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("mousemove",this.mousemove,!1),window.removeEventListener("mouseup",this.mouseup,!1),this.wangEditorEditableContainer.removeEventListener("input",this.input,!1)}}]),e}(),oe={mounted:function(){var e=this;this.$nextTick((function(){e.textElem=e.editor.$textElem.elems[0],e.textElem.addEventListener("paste",e.pasteTable,!0),e.tableObserve()}))},methods:{pasteTable:function(e){var t=e.clipboardData||window.clipboardData,n=t.getData("text"),l=t.getData("text/html"),a=function(e){for(var t=e.items,n=e.types,l=null,a=0;a<n.length;a++)if("Files"===n[a]){l=t[a];break}return l},i='xmlns="http://www.w3.org/TR/REC-html40',r=l&&l.includes(i)&&l.includes("office:excel"),o=l&&l.includes(i)&&l.includes("office:word"),s=l&&l.includes(i)&&!l.includes("office:excel")&&!l.includes("office:word"),c=a(t);c&&"file"===c.kind&&c.type.match(/^image\//i);if(" "===n){e.stopPropagation(),e.preventDefault();var d=window.localStorage.getItem("tableMergeCell_active")||"";if(!d.includes("tableMergeCell_active"))return;var h=document.createElement("div");h.insertAdjacentHTML("beforeend",d);var u=h.firstElementChild,m=window.getSelection();if(!m.rangeCount)return!1;var v=m.getRangeAt(0);v.insertNode(u),q(),m.collapseToEnd();var f=function(e){while("P"!==e.tagName&&e.parentNode)e=e.parentNode;return e},g=f(u);if(!g||"P"!==g.tagName)return;g.insertAdjacentElement("afterend",u)}},initTableInteraction:function(){if(!this.$refs.editor)throw new Error('请为wangEditor富文本容器元素提供ref="editor"属性');var e=function(e){while(e&&e.parentNode&&"TABLE"!==e.parentNode.tagName)e=e.parentNode;return e.parentNode};this.tables=this.$refs.editor.querySelectorAll(".w-e-text table"),this.tables.forEach((function(t){e(t)||(t.tableMergeCellInstance||(t.tableMergeCellInstance=new ae(t,{onAddCol:function(e){t.tableColumnResizerInstance.handleAddCol(e)},onDelCol:function(e){t.tableColumnResizerInstance.handleDelCol(e)}})),t.tableColumnResizerInstance||(t.tableColumnResizerInstance=new re(t)))}))},tableObserve:function(){var e=this,t=function(t){var n=!0,l=!1,a=void 0;try{for(var i,r=t[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var o=i.value,s=o.addedNodes;if(s.length){var c=te(o),d=ne(o);if(c&&(D(c),H(c),e.initTableInteraction()),d){var h=e.textElem.querySelector('[src="'.concat(d,'"]'));h&&h.remove()}}}}catch(u){l=!0,a=u}finally{try{n||null==r.return||r.return()}finally{if(l)throw a}}};this.observer=new MutationObserver(t),this.observer.observe(this.textElem,{childList:!0,subtree:!0})}},beforeDestroy:function(){this.tables&&this.tables.forEach((function(e){e.tableMergeCellInstance&&(e.tableMergeCellInstance.destroy(),e.tableMergeCellInstance=null),e.tableColumnResizerInstance&&(e.tableColumnResizerInstance.destroy(),e.tableColumnResizerInstance=null)})),this.tables=null,this.textElem.removeEventListener("paste",this.pasteTable,!0),this.observer&&this.observer.disconnect()}},se=n("8b83"),ce=n("c65a"),de=n("c03e"),he=function(e){function t(e){Object(N["a"])(this,t);var n=I.a.$('<div class="w-custom-menu" data-title="新增公式参数">\n                <i>新增公式参数</i>\n            </div>\n            ');return Object(se["a"])(this,Object(ce["a"])(t).call(this,n,e))}return Object(de["a"])(t,e),Object(R["a"])(t,[{key:"clickHandler",value:function(){var e=new CustomEvent("addFormula");window.dispatchEvent(e)}},{key:"tryChangeActive",value:function(){this.active()}}]),t}(I.a.BtnMenu),ue={name:"about",mixins:[oe],components:{FormulaPop:A},data:function(){return{value:"",visible:!1,latex:"",type:"add"}},created:function(){var e=this;setTimeout((function(){e.value="\n                \n            "}),1e3),this.latexArray=[]},mounted:function(){this.initEditor(),this.listenMenuClick()},beforeDestroy:function(){window.removeEventListener("addFormula",this.addMath,!0)},methods:{latexToHtml:function(e){var t=window.$&&window.$("<span></span>").mathquill("editable").mathquill("write",e).mathquill("html");return'<span class="mathquill-rendered-math">'.concat(t,"</span>")},addMath:function(){this.type="add",this.latex="",this.visible=!0},editMath:function(e,t){this.type="edit",this.latex=e,this.currentIndex=t,this.visible=!0},confirm:function(e){if("add"===this.type){console.log("add");var t=window.$("<span></span>").mathquill("editable").mathquill("write",e).mathquill("html");t='<span contenteditable="false" class="mathquill-rendered-math">'.concat(t,"</span>");var n=this.editor.selection.getRange();n.insertNode($(t).get(0)),n.collapse(),this.latexArray.push({latex:e})}else"edit"===this.type&&(console.log("edit"),this.latexArray[this.currentIndex].latex=e)},getHtml:function(){this.newHtml=this.editor.txt.html(),this.$refs.newHtml.innerHTML=this.newHtml},setHtml:function(){this.editor.txt.html(this.newHtml)},initEditor:function(){this.editor=new I.a(this.$refs.editor),window.editor||(window.editor=this.editor);var e="alertMenuFormulaKey";this.editor.menus.extend(e,he),this.editor.config.menus=this.editor.config.menus.concat(e),this.editor.config.onchangeTimeout=200,this.editor.config.zIndex=9,this.editor.create()},listenMenuClick:function(){window.addEventListener("addFormula",this.addMath,!0)}}},me=ue,ve=(n("5795"),Object(r["a"])(me,h,u,!1,null,null,null)),fe=ve.exports;l["a"].use(d["a"]);var ge=[{path:"/",name:"home",component:fe}],pe=new d["a"]({routes:ge}),be=pe,ye=n("2f62");l["a"].use(ye["a"]);var we=new ye["a"].Store({state:{},mutations:{},actions:{},modules:{}});n("720a"),n("1e51");l["a"].use(P["a"]),l["a"].prototype.$confirm=P["a"].confirm,l["a"].prototype.$info=P["a"].info,l["a"].config.productionTip=!1,new l["a"]({router:be,store:we,render:function(e){return e(c)}}).$mount("#app")},5795:function(e,t,n){"use strict";var l=n("6868"),a=n.n(l);a.a},"5c0b":function(e,t,n){"use strict";var l=n("9c0c"),a=n.n(l);a.a},6868:function(e,t,n){},"720a":function(e,t,n){},"9c0c":function(e,t,n){},be5c:function(e,t,n){"use strict";var l=n("07f7"),a=n.n(l);a.a}});
//# sourceMappingURL=app.6528d918.js.map