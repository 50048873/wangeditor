(function(e){function t(t){for(var l,o,i=t[0],s=t[1],c=t[2],u=0,h=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&h.push(a[o][0]),a[o]=0;for(l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l]);d&&d(t);while(h.length)h.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],l=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(l=!1)}l&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var l={},a={app:0},r=[];function o(t){if(l[t])return l[t].exports;var n=l[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=l,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)o.d(n,l,function(t){return e[t]}.bind(null,l));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var d=s;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"1e51":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var l=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("router-link",{attrs:{to:"/"}},[e._v("tableMergeCell")])],1),n("router-view")],1)},r=[],o=(n("5c0b"),n("2877")),i={},s=Object(o["a"])(i,a,r,!1,null,null,null),c=s.exports,d=n("8c4f"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"editor"},[n("div",{domProps:{innerHTML:e._s(e.backendHTML)}})]),n("button",{attrs:{type:"button",id:"btn1"},on:{click:e.getHtml}},[e._v("获取html")]),n("button",{attrs:{type:"button",id:"btn2"},on:{click:e.setHtml}},[e._v("设置html")]),n("div",{ref:"newHtml",staticClass:"newHtml"})])},h=[],v=n("6fad"),f=n.n(v),m=(n("4160"),n("caad"),n("2532"),n("159b"),n("a630"),n("45fc"),n("0d03"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3"),n("5319"),n("1276"),n("284c")),g=n("e587"),p=n("9f12"),b=n("53fe"),y=n("2fa7"),C=n("ed3b"),w=(n("cd09"),{btnDisabledColor:"#ddd",onAddCol:null}),E=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(p["a"])(this,e),Object(y["a"])(this,"colorChange",(function(e){var t=e.target,l=t.value,a=n.colorPicker.selectedCells;a.length&&a.forEach((function(e){e.style.backgroundColor=l})),n.colorPicker&&(n.colorPicker.removeEventListener("input",n.colorChange),n.colorPicker.remove(),n.colorPicker=null),n.removeClass()})),Object(y["a"])(this,"mergeCell",(function(){for(var e=n.getSelectedCells(),t=e.length,l=n.indexStart,a=n.indexEnd,r=a.row-l.row+1,o=a.col-l.col+1,i=null,s=0;s<t;s++){var c=e[s];if(c.innerText){i=c;break}}e.forEach((function(e,t){if(0===t){if(e.setAttribute("rowspan",r),e.setAttribute("colspan",o),!e.innerText&&i){e.innerHTML=i.innerHTML,e.removeAttribute("style");var l=i.getAttribute("style");l&&e.setAttribute("style",l)}}else e.style.display="none";n.removeClass(e)}))})),Object(y["a"])(this,"unMergeCell",(function(){var e=null;n.indexStart=n.getCellIndex(n.cellEnd),e=n.getCellSpanProperty(n.cellEnd),n.indexEnd={row:e.rowspan-1+n.indexStart.row,col:e.colspan-1+n.indexStart.col};var t=n.getSelectedCells();t.forEach((function(e,t){0===t?(e.removeAttribute("rowspan"),e.removeAttribute("colspan")):e.style.removeProperty("display"),n.removeClass(e)}))})),Object(y["a"])(this,"menuClick",(function(t){var l=t.target,a=window.getComputedStyle(l).color,r=e.colorToRgb(n.opts.btnDisabledColor);if(a!==r){var o=l.dataset.key,i=n.getCellIndex(n.contextmenuCell),s=i.row,c=i.col;switch(o){case"textAlignLeft":n.textAlignLeft();break;case"textAlignCenter":n.textAlignCenter();break;case"textAlignRight":n.textAlignRight();break;case"addBackgroundColor":n.addBackgroundColor();break;case"delBackgroundColor":n.delBackgroundColor();break;case"delTable":n.delTable();break;case"addRow":n.addRow(s);break;case"delRow":n.delRow(s);break;case"addCol":n.addCol(c);break;case"delCol":n.delCol(c);break;case"addTh":n.addTh();break;case"delTh":n.delTh();break;case"merge":n.mergeCell();break;case"unMerge":n.unMergeCell();break}n.menuEle&&(n.menuEle.style.display="none")}})),Object(y["a"])(this,"mousedown",(function(t){var l=t.target,a=t.button;if(!n.tableIsInTable(l)&&!e.isTheadChild(l)&&0===a){l=e.getTargetParentCell(l);var r=l,o=r.tagName;"TD"!==o&&"TH"!==o||(n.ready=!0,n.cellStart=l,n.indexStart=n.getCellIndex(l),n.removeClass(),n.addClass(l))}})),Object(y["a"])(this,"removeSomeNoSelfIsClicked",(function(e){var t=e.target;n.menuEle&&!n.menuEle.contains(t)&&(n.menuEle.style.display="none");var l=t.dataset.key;n.tableEle.contains(t)||"addBackgroundColor"===l||n.removeClass(),n.colorPicker&&n.colorPicker.remove()})),Object(y["a"])(this,"mousemove",(function(t){if(n.ready){var l=t.target;if(l=e.getTargetParentCell(l),!n.tableEle.contains(l))return;n.cellEnd=l,n.indexEnd=n.getCellIndex(l),n.removeClass(),n.highlightSelectedCells();var a=window.getSelection();n.cellStart!==n.cellEnd&&a.collapseToEnd()}})),Object(y["a"])(this,"mouseup",(function(t){var l=t.target,a=t.button;0===a&&n.ready&&(l=e.getTargetParentCell(l),n.cellEnd=l,n.indexEnd=n.getCellIndex(l),n.ready=!1,n.cellStart!==n.cellEnd&&e.focusEle&&e.focusEle.focus())})),Object(y["a"])(this,"tableClick",(function(e){var t=e.target,l=e.button;0===l&&"INPUT"!==t.tagName&&n.tableEle.contains(t)&&e.stopPropagation()})),Object(y["a"])(this,"contextmenu",(function(e){e.preventDefault();var t=e.target,l=e.clientX,a=e.clientY;if(!n.tableIsInTable(t)){if(!n.menuEle){n.menuEle=document.createElement("ul"),n.menuEle.classList.add("tableMergeCell-contextmenu"),n.menuEle.addEventListener("click",n.menuClick,!1),n.menus.forEach((function(e){var t=document.createElement("li"),l=e.name,a=e.key;t.textContent=l,t.dataset.key=a,n["btn_".concat(a)]=t,n.menuEle.appendChild(t)})),document.body.appendChild(n.menuEle);var r=n.menuEle.getBoundingClientRect(),o=r.width,i=r.height;n.menuEle.dataset.width=o,n.menuEle.dataset.height=i}var s=document.documentElement,c=s.clientWidth,d=s.clientHeight,u=n.menuEle.dataset,h=u.width,v=u.height,f=c-l,m=d-a;f<h?(n.menuEle.style.right="10px",n.menuEle.style.removeProperty("left")):(n.menuEle.style.left="".concat(l,"px"),n.menuEle.style.removeProperty("right")),m<v?n.menuEle.style.height="".concat(m-10,"px"):n.menuEle.style.removeProperty("height"),n.menuEle.style.top="".concat(a,"px"),n.menuEle.style.display="block",n.contextmenuCell=t,n.handleMenuBtnMergeStatus(t),n.handleMenuBtnRowStatus(t),n.handleSomeMenuBtns(t)}})),Object(y["a"])(this,"copy",(function(t){t.preventDefault();var l=window.getSelection().toString();l?(t.clipboardData?t.clipboardData.setData("text/plain",l):window.clipboardData&&window.clipboardData.setData("text",l),e.copyedCellsArray=[]):(t.clipboardData?t.clipboardData.setData("text/plain",""):window.clipboardData&&window.clipboardData.setData("text",""),e.copyedCellsArray=n.getSelectedCells(!0))})),Object(y["a"])(this,"paste",(function(t){var l=t.clipboardData||window.clipboardData,a=n.getSelectedCells(!0);if(l.items.length>1){t.preventDefault();var r=l.getData("text"),o=e.handleExcelData(r);n.handlePaste(a,o)}else e.copyedCellsArray.length&&(t.preventDefault(),n.handlePaste(a,e.copyedCellsArray),n.indexStart=e.getIndexDefaultValue(),n.indexEnd=e.getIndexDefaultValue())})),Object(y["a"])(this,"keydown",(function(e){var t=e.key;if("Delete"===t){var l=n.getSelectedCells();l.forEach((function(e){e.innerHTML=""}))}})),this.opts=Object.assign({},w,l),this.tableEle=t,this.tBody=t.tBodies[0],this.rows=this.tBody.rows,this.tableClassName="tableMergeCell",this.menuEle=null,this.menus=[{name:"靠左",key:"textAlignLeft"},{name:"居中",key:"textAlignCenter"},{name:"靠右",key:"textAlignRight"},{name:"设置背景色",key:"addBackgroundColor"},{name:"删除背景色",key:"delBackgroundColor"},{name:"合并单元格",key:"merge"},{name:"取消合并单元格",key:"unMerge"},{name:"添加行",key:"addRow"},{name:"删除行",key:"delRow"},{name:"添加列",key:"addCol"},{name:"删除列",key:"delCol"},{name:"设置表头",key:"addTh"},{name:"取消表头",key:"delTh"},{name:"删除表格",key:"delTable"}],this.selectedCellClassName="tableMergeCell-selected",this.ready=!1,this.cellStart=null,this.cellEnd=null,this.indexStart=e.getIndexDefaultValue(),this.indexEnd=e.getIndexDefaultValue(),this.maxRowCount=0,this.maxColCount=0,this.contextmenuCell=null,this.init()}return Object(b["a"])(e,null,[{key:"colorToRgb",value:function(e){var t=document.createElement("span");t.style.color=e,document.body.appendChild(t);var n=window.getComputedStyle(t).color;return document.body.removeChild(t),n}},{key:"getIndexDefaultValue",value:function(){return{row:-1,col:-1}}},{key:"getTargetParentCell",value:function(e){while("TD"!==e.tagName&&"TH"!==e.tagName&&e.parentNode)e=e.parentNode;return e}},{key:"isTheadChild",value:function(e){while("THEAD"!==e.tagName&&e.parentNode)e=e.parentNode;return"THEAD"===e.tagName}},{key:"handleExcelData",value:function(e){e=e.replace(/\n/g,"n").replace(/\s/g,",").replace(/,{2,}/g,","),e=e.substring(0,e.length-2);var t=e.split(",n"),n=[];return t.forEach((function(e){var t=e.split(",");n.push(t)})),n}}]),Object(b["a"])(e,[{key:"init",value:function(){if(!this.tableEle&&1!==this.tableEle.ELEMENT_NODE&&"TABLE"!==this.tableEle.tagName)throw new Error("请传入table元素！");this.tableEle.classList.add(this.tableClassName),this.handleTableFromExcel(),this.addFocusEle(),this.syncMaxRowAndColCount(),this.addEvent()}},{key:"destroy",value:function(){this.removeEvent(),this.menuEle&&(this.menuEle.removeEventListener("click",this.menuClick,!1),this.menuEle.remove()),e.focusEle&&e.focusEle.remove()}},{key:"handleTableFromExcel",value:function(){var e=Object(g["a"])(this.tableEle.children,2),t=e[0],n=e[1];if("COLGROUP"===t.tagName)for(var l=n.children,a=l.length,r=0;r<a;r++)for(var o=l[r],i=o.cells,s=i.length,c=0;c<s;c++){var d=i[c],u=d.getAttribute("rowspan"),h=d.getAttribute("colspan");if(u>=1)for(var v=1;v<u;v++){var f=l[r+v].insertCell(c);f.style.display="none"}if(h>=1)for(var m=1;m<h;m++){var p=o.insertCell(c+m);p.style.display="none"}}}},{key:"addFocusEle",value:function(){e.focusEle||(e.focusEle=document.createElement("button"),e.focusEle.className="tableMergeCell-focusEle",document.body.appendChild(e.focusEle))}},{key:"addCellLocation",value:function(){var e=this.rows;e.forEach((function(e,t){var n=e.children;n.forEach((function(e,n){e.textContent=t+"-"+n}))}))}},{key:"syncMaxRowAndColCount",value:function(){var e=this.rows;e.length?(this.maxRowCount=e.length,this.maxColCount=e[0].childElementCount):(this.maxRowCount=0,this.maxColCount=0)}},{key:"addBackgroundColor",value:function(){var e=this.getSelectedCells();if(e.length){this.colorPicker=document.createElement("input"),this.colorPicker.setAttribute("type","color"),this.colorPicker.className="tableMergeCell-colorPicker",this.colorPicker.addEventListener("input",this.colorChange,!1),this.colorPicker.selectedCells=e;var t=e[e.length-1];t.appendChild(this.colorPicker),this.colorPicker.click()}}},{key:"delBackgroundColor",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.removeProperty("background-color")}))}},{key:"tableIsInTable",value:function(e){while(e&&"TABLE"!==e.tagName)e=e.parentNode;return this.tableEle!==e&&this.tableEle.contains(e)}},{key:"addClass",value:function(e){e.className.includes(this.selectedCellClassName)||e.classList.add(this.selectedCellClassName)}},{key:"removeClass",value:function(e){var t=this;if(e)e.classList.remove(this.selectedCellClassName),""===e.className&&e.removeAttribute("class");else{var n=this.tableEle.querySelectorAll(".tableMergeCell-selected");n.length&&n.forEach((function(e){e.classList.remove(t.selectedCellClassName),""===e.className&&e.removeAttribute("class")}))}}},{key:"highlightSelectedCells",value:function(){var e=this,t=this.rows,n=this.selectedCellsIsValid(t);if(n){var l=this.getSelectedCells();l.forEach((function(t){e.addClass(t)}))}}},{key:"getSelectedCells",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexStart,n=this.indexEnd,l=[],a=[],r=this.rows,o=0;o<this.maxRowCount;o++){for(var i=r[o],s=i.children,c=s.length,d=[],u=0;u<c;u++){var h=s[u];o>=t.row&&o<=n.row&&u>=t.col&&u<=n.col&&(l.push(h),d.push(h))}d.length&&a.push(d)}return e?a:l}},{key:"selectedCellsIsValid",value:function(){var e=this,t=this.cellStart.getAttribute("rowspan"),n=this.cellEnd&&this.cellEnd.getAttribute("rowspan");if(t||n)return!1;var l=this.getSelectedCells(),a=l.some((function(t){return"none"===t.style.display||e.getIsMergedCellBool(t)}));return!a}},{key:"getCellIndex",value:function(e){var t={row:-1,col:-1};if(!this.cellStart)return t;var n=this.cellStart.tagName,l=this.rows;if("TH"===n){var a=l[0],r=a.children,o=r.length;t.row=0;for(var i=0;i<o;i++){var s=r[i];if(s===e){t.col=i;break}}}else if("TD"===n)for(var c=0;c<this.maxRowCount;c++){for(var d=l[c],u=d.children,h=u.length,v=0;v<h;v++){var f=u[v];if(f===e){t.row=c,t.col=v;break}}if(t.row>0)break}return t}},{key:"getCellSpanProperty",value:function(e){var t=e.getAttribute("rowspan"),n=e.getAttribute("colspan");return t=t?1*t:1,n=n?1*n:1,{rowspan:t,colspan:n}}},{key:"getIsMergedCellBool",value:function(e){var t=this.getCellSpanProperty(e),n=t.rowspan,l=t.colspan,a=Math.max(n,l);return a>1}},{key:"getSelectedCellsByClassName",value:function(){return Array.from(this.tableEle.querySelectorAll(".".concat(this.selectedCellClassName)))}},{key:"getMergedRowIndexArray",value:function(e,t){var n=e+t-1,l=[];do{l.push(e),e++}while(e<=n);return l}},{key:"getMergedColIndexArray",value:function(e,t){var n=e+t-1,l=[];do{l.push(e),e++}while(e<=n);return l}},{key:"handleMenuBtnMergeStatus",value:function(e){var t=this.opts.btnDisabledColor;this.isMergedCell=this.getIsMergedCellBool(e);var n=this.getSelectedCellsByClassName();n.length?this.cellStart===this.cellEnd?this.cellEnd.getAttribute("rowspan")||this.cellEnd.getAttribute("colspan")?this.btn_unMerge.style.removeProperty("color"):(this.btn_merge.style.color=t,this.btn_unMerge.style.color=t):this.getIsMergedCellBool(e)?(this.btn_merge.style.color=t,this.btn_unMerge.style.removeProperty("color")):(this.btn_merge.style.removeProperty("color"),this.btn_unMerge.style.color=t):(this.btn_merge.style.color=t,this.btn_unMerge.style.color=t)}},{key:"handleMenuBtnRowStatus",value:function(e){var t=this.opts.btnDisabledColor;"TH"===e.tagName?this.btn_addRow.style.color=t:this.btn_addRow.style.removeProperty("color");var n=this.getCellSpanProperty(e),l=n.rowspan,a=n.colspan;l>1||a>1?(this.btn_delRow.style.color=t,this.btn_delCol.style.color=t):(this.btn_delRow.style.removeProperty("color"),this.btn_delCol.style.removeProperty("color"))}},{key:"handleSomeMenuBtns",value:function(){var e=this.opts.btnDisabledColor,t=this.getSelectedCellsByClassName();t.length?(this.btn_textAlignLeft.style.removeProperty("color"),this.btn_textAlignCenter.style.removeProperty("color"),this.btn_textAlignRight.style.removeProperty("color"),this.btn_addBackgroundColor.style.removeProperty("color"),this.btn_delBackgroundColor.style.removeProperty("color")):(this.btn_addBackgroundColor.style.color=e,this.btn_delBackgroundColor.style.color=e,this.btn_textAlignLeft.style.color=e,this.btn_textAlignCenter.style.color=e,this.btn_textAlignRight.style.color=e)}},{key:"handleMergedCellByDelCol",value:function(e){for(var t=this.rows,n=t.length,l=0;l<n;l++)for(var a=t[l],r=a.children,o=r.length,i=0;i<o;i++){var s=r[i],c=this.getCellSpanProperty(s),d=c.colspan;d>1&&e>i&&e<i+d&&s.setAttribute("colspan",d-1)}}},{key:"delTable",value:function(){this.tableEle.remove()}},{key:"delEmptyTable",value:function(){var e=this.rows;e.length&&e[0].children.length||this.delTable()}},{key:"addRow",value:function(e){var t=this,n=this.maxColCount,l=this.tBody,a=this.getRelatedMergedRowCells(e,"addRow"),r=[];a.forEach((function(e){var n=t.getCellSpanProperty(e),l=n.rowspan,a=n.colspan,o=t.getCellIndex(e),i=o.col;r.push.apply(r,Object(m["a"])(t.getMergedColIndexArray(i,a))),e.setAttribute("rowspan",l+1)}));for(var o=l.insertRow(e),i=0;i<n;i++)o.insertCell(i);r.forEach((function(e){o.children[e].style.display="none"})),this.syncMaxRowAndColCount()}},{key:"getRelatedMergedRowCells",value:function(e,t){var n=this,l=this.rows,a=[];return l.forEach((function(l,r){var o=l.children;o.forEach((function(l){var o=n.getCellSpanProperty(l),i=o.rowspan;i>1&&n.rowIsInMergedRow(r,i,e,t)&&a.push(l)}))})),a}},{key:"rowIsInMergedRow",value:function(e,t,n,l){return"addRow"===l?n>e&&n<=e+t-1:"delRow"===l?n>=e&&n<=e+t-1:void 0}},{key:"addCol",value:function(e){var t=this,n=this.opts.onAddCol;this.syncMaxRowAndColCount();for(var l=this.maxRowCount,a=this.rows,r=0;r<l;r++){var o=a[r],i=o.children[e],s="TH"===i.tagName?"<th></th>":"<td></td>";i.insertAdjacentHTML("beforebegin",s)}a.forEach((function(n,l){var r=n.children;r.forEach((function(n,o){var i=t.getCellSpanProperty(n),s=i.rowspan,c=i.colspan;if(c>1&&e>o&&e<=o+c-1){n.setAttribute("colspan",c+1),r[e].style.display="none";var d=s,u=l;while(d>1)a[++u].children[e].style.display="none",d--}}))})),this.syncMaxRowAndColCount(),n&&n()}},{key:"delRow",value:function(e){var t=this,n=this.tBody,l=this.rows,a=this.getRelatedMergedRowCells(e,"delRow");a.forEach((function(n){var a=t.getCellIndex(n),r=a.row,o=a.col;r===e?t.delFirstRow(l,o,n,e):t.delOtherRow(n)})),n.deleteRow(e),this.delEmptyTable(),this.syncMaxRowAndColCount()}},{key:"delOtherRow",value:function(e){var t=this.getCellSpanProperty(e),n=t.rowspan;e.setAttribute("rowspan",n-1)}},{key:"delFirstRow",value:function(e,t,n,l){var a=this.getCellSpanProperty(n),r=a.rowspan,o=a.colspan,i=e[l+1],s=i.children[t];s.setAttribute("rowspan",r-1),s.setAttribute("colspan",o),s.style.display="table-cell"}},{key:"getRelatedMergedColCells",value:function(e){var t=this,n=this.rows,l=[];return n.forEach((function(n){var a=n.children;a.forEach((function(n,a){var r=t.getCellSpanProperty(n),o=r.colspan;o>1&&e>=a&&e<=a+o-1&&l.push(n)}))})),l}},{key:"delOtherCol",value:function(e){var t=this.getCellSpanProperty(e),n=t.colspan;e.setAttribute("colspan",n-1)}},{key:"delFirstCol",value:function(e){var t=this.getCellSpanProperty(e),n=t.rowspan,l=t.colspan,a=e.nextElementSibling;a.setAttribute("colspan",l-1),a.setAttribute("rowspan",n),a.style.display="table-cell"}},{key:"delCol",value:function(e){var t=this,n=this.rows,l=this.getRelatedMergedColCells(e);l.forEach((function(n){var l=t.getCellIndex(n),a=l.col;a===e?t.delFirstCol(n):t.delOtherCol(n)})),n.forEach((function(t){t.deleteCell(e)})),this.delEmptyTable(),this.syncMaxRowAndColCount()}},{key:"addTh",value:function(){var e=this.rows[0],t=e.children,n=document.createElement("tr");if("TD"===t[0].tagName){for(var l=t.length,a=0;a<l;a++){var r=t[a];if(this.getIsMergedCellBool(r)){C["a"]&&C["a"].confirm({title:"提示",content:"请先手动取消第一行合并的单元格！",zIndex:10009});break}var o=document.createElement("th");o.innerHTML=r.innerHTML,n.appendChild(o)}n.childElementCount===l&&(e.innerHTML=n.innerHTML)}}},{key:"delTh",value:function(){var e=this.rows[0],t=e.children,n=document.createElement("tr");"TH"===t[0].tagName&&(t.forEach((function(e){var t=document.createElement("td");t.innerHTML=e.innerHTML,n.appendChild(t)})),e.innerHTML=n.innerHTML)}},{key:"textAlignLeft",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="left"}))}},{key:"textAlignCenter",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="center"}))}},{key:"textAlignRight",value:function(){var e=this.getSelectedCells();e.forEach((function(e){e.style.textAlign="right"}))}},{key:"handlePaste",value:function(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new Error("粘贴单元格或复制单元格不是数组");var n=e.length,l=t.length,a=e[0],r=t[0];if(!a)throw new Error("粘贴的单元格未获取到第一行");if(!r)throw new Error("复制的单元格未获取到第一行");var o=a.length,i=r.length;if(n===l&&o===i)for(var s=0;s<n;s++)for(var c=e[s],d=t[s],u=0;u<o;u++){var h=c[u],v=d[u];if(h&&v)if("string"!==typeof v){var f=this.getCellSpanProperty(h),m=f.rowspan,g=f.colspan,p=this.getCellSpanProperty(v),b=p.rowspan,y=p.colspan;if(m===b&&g===y)h.outerHTML=v.outerHTML;else{var w=v.cloneNode(!0);(b>1||y>1)&&m<=1&&g<=1?(w.removeAttribute("rowspan"),w.removeAttribute("colspan"),h.outerHTML=w.outerHTML):(m>1||g>1)&&b<=1&&y<=1&&(w.setAttribute("rowspan",m),w.setAttribute("colspan",g),h.outerHTML=w.outerHTML)}}else h.innerText=v}else if((l>1||i>1)&&1===n&&1===o)for(var E=this.indexStart,k={indexStart:E,indexEnd:{row:E.row+l-1,col:E.col+i-1}},x=k.indexStart.row,T=k.indexEnd.row,S=k.indexStart.col,A=k.indexEnd.col,M=this.rows,L=x,P=0;L<=T;L++,P++){var R=M[L];if(R)for(var I=R.children,N=S,O=0;N<=A;N++,O++){var H=I[N];if(H){var D=t[P][O];if(H&&D)if("string"!==typeof D){var j=this.getCellSpanProperty(H),B=j.rowspan,_=j.colspan;B<=1&&_<=1&&(H.outerHTML=D.outerHTML)}else H.innerText=D}}}else C["a"]&&C["a"].confirm({title:"提示",content:"目前只支持两种模式：1、复制时选择的行列与粘贴时选择的行列相同（简称一对一或多对多）；2、复制时选择的行列不限，粘贴时只选一个单元格（简称多对一）；",zIndex:10009})}},{key:"addEvent",value:function(){window.addEventListener("mousedown",this.mousedown,!1),window.addEventListener("mousedown",this.removeSomeNoSelfIsClicked,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseup",this.mouseup,!1),this.tableEle.addEventListener("click",this.tableClick,!1),this.tableEle.addEventListener("contextmenu",this.contextmenu,!1),window.addEventListener("copy",this.copy,!1),window.addEventListener("paste",this.paste,!1),window.addEventListener("keydown",this.keydown,!0)}},{key:"removeEvent",value:function(){window.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("mousedown",this.removeSomeNoSelfIsClicked,!1),window.removeEventListener("mousemove",this.mousemove,!1),window.removeEventListener("mouseup",this.mouseup,!1),this.tableEle.removeEventListener("click",this.tableClick,!1),this.tableEle.removeEventListener("contextmenu",this.contextmenu,!1),window.removeEventListener("copy",this.copy,!1),window.removeEventListener("paste",this.paste,!1),window.removeEventListener("keydown",this.keydown,!0)}}]),e}();Object(y["a"])(E,"focusEle",null),Object(y["a"])(E,"copyedCellsArray",[]);n("720a"),n("99af"),n("d81d"),n("13d5"),n("a9e3"),n("c35a"),n("b680");var k={colMinWidth:50},x=function(){function e(t){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(p["a"])(this,e),Object(y["a"])(this,"reset",(function(){n.addResizeHandShank(),n.setWidth()})),Object(y["a"])(this,"mousedown",(function(e){var t=e.target,l=e.button,a=e.clientX;0===l&&t.className.includes(n.handshankCls)?(n.handshank=t,n.handshank.classList.add(n.handshankHover),n.clientX=a,n.addSubline()):n.handshank=null})),Object(y["a"])(this,"mousemove",(function(e){if(n.handshank){e.preventDefault();var t=e.clientX;n.diff=t-n.clientX,n.handshank.style.transform="translateX(".concat(n.diff,"px)")}})),Object(y["a"])(this,"mouseup",(function(e){if(n.handshank){var t=e.clientX,l=n.handshank.dataset.col,a=n.colgroup.children[l],r=a.getBoundingClientRect(),o=r.width,i=o+n.diff,s=n.opts.colMinWidth,c=Math.max(s,i);n.tableEle.contains(n.handshank)&&t-n.clientX!==0&&(a.style.width="".concat(c,"px")),n.handshank.style.transform="none",n.handshank.classList.remove(n.handshankHover),n.removeSubline();var d=n.getColsWidth();n.setTableWidth(d),n.handshank=null}})),Object(y["a"])(this,"input",(function(){var e=n.tableEle.tBodies[0],t=e.rows[0],l=t.children[0],a=l.getBoundingClientRect(),r=a.height,o=n.thead.children[0].children;r>30?o.forEach((function(e){var t=e.querySelector(".".concat(n.handshankCls));t.style.height="".concat(r,"px")})):o.forEach((function(e){var t=e.querySelector(".".concat(n.handshankCls));t.style.removeProperty("height")}))})),this.opts=Object.assign({},k,l),this.tableEle=t,this.wangEditorEditableContainer=e.getTargetParentElement(t,"w-e-text"),this.handshank=null,this.handshankCls="tableMergeCell-handshank",this.subline="tableMergeCell-subline",this.handshankHover="tableMergeCell-handshank-hover",this.init()}return Object(b["a"])(e,null,[{key:"getTargetParentElement",value:function(e,t){while(e.className&&!e.className.includes(t)&&e.parentNode)e=e.parentNode;return e}}]),Object(b["a"])(e,[{key:"init",value:function(){if(!this.tableEle||1!==this.tableEle.ELEMENT_NODE||"TABLE"!==this.tableEle.tagName)throw new Error("请传入table元素！");this.initTheadAndColgroup(),this.getDefaultWidth(),this.setWidth(),this.addResizeHandShank(),this.addEvent()}},{key:"destroy",value:function(){this.removeEvent()}},{key:"initTheadAndColgroup",value:function(){for(var e=this.tableEle.tBodies[0],t=e.rows,n=t[0].childElementCount,l=document.createElement("colgroup"),a=0;a<n;a++){var r=document.createElement("col");l.appendChild(r)}this.colgroup=e.insertAdjacentElement("beforebegin",l);var o=document.createElement("thead"),i=document.createElement("tr");i.className="tableMergeCell-handshank-container";for(var s=0;s<n;s++){var c=document.createElement("th");i.appendChild(c)}o.appendChild(i),this.thead=e.insertAdjacentElement("beforebegin",o)}},{key:"getDefaultWidth",value:function(){var e=this.tableEle.getBoundingClientRect(),t=e.width,n=this.tableEle.tBodies[0].rows,l=n[0].childElementCount;this.average=(t/l).toFixed()}},{key:"setWidth",value:function(){var e=this,t=this.colgroup.children;t.forEach((function(t){var n=t.style.width;n||(t.style.width="".concat(e.average,"px"))})),this.setTableWidth(this.average*t.length)}},{key:"addResizeHandShank",value:function(){var e=this,t=this.thead.children[0].children;t.forEach((function(t,n){var l=t.querySelector(".".concat(e.handshankCls));l&&l.remove();var a='<i data-col="'.concat(n,'" contenteditable="false" class="').concat(e.handshankCls,'"></i>');t.insertAdjacentHTML("beforeend",a)}))}},{key:"addSubline",value:function(){this.handshank.classList.add(this.subline)}},{key:"removeSubline",value:function(){this.handshank.classList.remove(this.subline)}},{key:"setTableWidth",value:function(e){if("number"!==typeof e)throw new Error("表格宽的参数为Number类型！");e=e.toFixed(),this.tableEle.setAttribute("width","".concat(e,"px"))}},{key:"getColsWidth",value:function(){var e=this.colgroup.children,t=Array.from(e).map((function(e){return Number.parseFloat(e.style.width)})),n=t.reduce((function(e,t){return e+t}));return n}},{key:"addEvent",value:function(){window.addEventListener("mousedown",this.mousedown,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseup",this.mouseup,!1),this.wangEditorEditableContainer.addEventListener("input",this.input,!1)}},{key:"removeEvent",value:function(){window.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("mousemove",this.mousemove,!1),window.removeEventListener("mouseup",this.mouseup,!1),this.wangEditorEditableContainer.removeEventListener("input",this.input,!1)}}]),e}(),T=(n("1e51"),{mounted:function(){var e=this;this.$nextTick((function(){e.addInsertTableIconlistener(),e.addPasteTableListener()}))},updated:function(){var e=this;this.$nextTick((function(){e.initTableInteraction()}))},methods:{initTableInteraction:function(){if(!this.$refs.editor)throw new Error('请为wangEditor富文本容器元素提供ref="editor"属性');var e=function(e){while(e&&e.parentNode&&"TABLE"!==e.parentNode.tagName)e=e.parentNode;return e.parentNode};this.tables=this.$refs.editor.querySelectorAll(".w-e-text table"),this.tables.forEach((function(t){e(t)||(t.tableMergeCellInstance||(t.tableMergeCellInstance=new E(t,{onAddCol:function(){t.tableColumnResizerInstance.reset()}})),t.tableColumnResizerInstance||(t.tableColumnResizerInstance=new x(t)))}))},addInsertTextListener:function(){this.insertText=this.iconTable.querySelector("button.right"),this.insertText&&this.insertText.addEventListener("click",this.initTableInteraction,!1)},addInsertTableIconlistener:function(){this.iconTable=this.$refs.editor.querySelector("[data-title='表格']"),this.iconTable&&this.iconTable.addEventListener("click",this.addInsertTextListener,!1)},handlePaste:function(e){var t=(e.clipboardData||window.clipboardData).getData("text/html");t&&t.includes("<table")&&this.initTableInteraction()},addPasteTableListener:function(){this.$refs.editor.addEventListener("paste",this.handlePaste,!1)}},beforeDestroy:function(){this.tables&&this.tables.forEach((function(e){e.tableMergeCellInstance&&e.tableMergeCellInstance.destroy(),e.tableColumnResizerInstance&&e.tableColumnResizerInstance.destroy()})),this.tables=null,this.iconTable&&this.iconTable.removeEventListener("click",this.addInsertTextListener,!1),this.insertText&&this.insertText.removeEventListener("click",this.initTableInteraction,!1),this.$refs.editor&&this.$refs.editor.removeEventListener("paste",this.handlePaste,!1)}}),S={name:"about",mixins:[T],data:function(){return{backendHTML:""}},mounted:function(){this.initEditor()},methods:{getHtml:function(){this.newHtml=this.editor.txt.html(),this.$refs.newHtml.innerHTML=this.newHtml},setHtml:function(){this.editor.txt.html(this.newHtml)},initEditor:function(){this.editor=new f.a(this.$refs.editor),this.editor.config.onchangeTimeout=200,this.editor.create()}}},A=S,M=(n("e76e"),Object(o["a"])(A,u,h,!1,null,null,null)),L=M.exports;l["a"].use(d["a"]);var P=[{path:"/",name:"home",component:L}],R=new d["a"]({routes:P}),I=R,N=n("2f62");l["a"].use(N["a"]);var O=new N["a"].Store({state:{},mutations:{},actions:{},modules:{}});l["a"].use(C["a"]),l["a"].prototype.$confirm=C["a"].confirm,l["a"].prototype.$info=C["a"].info,l["a"].config.productionTip=!1,new l["a"]({router:I,store:O,render:function(e){return e(c)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var l=n("9c0c"),a=n.n(l);a.a},"720a":function(e,t,n){},"91aa":function(e,t,n){},"9c0c":function(e,t,n){},e76e:function(e,t,n){"use strict";var l=n("91aa"),a=n.n(l);a.a}});
//# sourceMappingURL=app.369ee4d2.js.map